<!DOCTYPE html>
<html lang="en">

<head>


<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="author" content="Matthias Altmann">
<meta name="description" content="SANS Holiday Hack Challenge 2024 Writeup / Walkthrough">

<title>SANS Holiday Hack Challenge 2024 Writeup</title>

<!-- Bootstrap core CSS -->
<link href="/blog/vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">

<!-- Bootstrap core JavaScript -->
<script src="/blog/vendor/jquery/jquery.min.js"></script>
<script src="/blog/vendor/bootstrap/js/bootstrap.bundle.min.js"></script>

<!-- Custom fonts for this template -->
<link href="/blog/vendor/fontawesome-free-web/css/all.css" rel="stylesheet" type="text/css">
<link href='/blog/vendor/fonts-googleapis/lora.css' rel='stylesheet' type='text/css'>
<link href='/blog/vendor/fonts-googleapis/opensans.css' rel='stylesheet' type='text/css'>

<link rel="shortcut icon" href="/blog/assets/img/favicon.ico" type="image/x-icon">
<link rel="icon" href="/blog/assets/img/favicon.ico" type="image/x-icon">

<script src="/blog/vendor/jquery/jquery.min.js"></script>
<script src="/blog/vendor/gsap/gsap.min.js"></script>

<script src="/blog/vendor/highlight/highlight.pack.js"></script>
<link href="/blog/vendor/highlight/styles/default.css" rel="stylesheet" type="text/css">
<script>hljs.initHighlightingOnLoad();</script>

<link href="/blog/vendor/malihu-jquery-custom-scrollbar/jquery.mCustomScrollbar.min.css" rel="stylesheet">
<script src="/blog/vendor/malihu-jquery-custom-scrollbar/jquery.mCustomScrollbar.js"></script>

<!-- Custom styles and scripts -->
<link href="/blog/css/clean-blog.min.css" rel="stylesheet">
<script src="/blog/js/clean-blog.min.js"></script>

<link href="/blog/css/svganimations.css" rel="stylesheet">

<script src="/blog/js/sidebar.js"></script>
<link href="/blog/css/sidebar.css" rel="stylesheet">

<script src="/blog/vendor/mermaid/mermaid-10.9.1.min.js"></script>

<!-- For atom rss feed that browser can detect rss on side -->
<link href="/blog/feed.xml" type="application/atom+xml" rel="alternate" title="Sitewide Atom feed" />





</head>

<body>

<!-- Navigation -->
<nav class="navbar navbar-expand-lg navbar-light fixed-top" id="mainNav">
    <div class="container px-4 px-lg-5">
        <a class="navbar-brand" id="nav-link-main" href="/blog/index.html">~/sec/f00tprint</a>
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarResponsive" aria-controls="navbarResponsive" aria-expanded="false" aria-label="Toggle navigation">
            Menu
            <i class="fa fa-bars"></i>
        </button>
        <div class="collapse navbar-collapse" id="navbarResponsive">
            <ul class="navbar-nav ms-auto py-4 py-lg-0">
                <li class="nav-item">
                    <a class="nav-link px-lg-3 py-3 py-lg-4" href="/blog/index.html">Posts</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link px-lg-3 py-3 py-lg-4" href="/blog/germancorner.html">German Corner</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link px-lg-3 py-3 py-lg-4" href="/blog/hhc/2024/writeup/en">Last Post</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link px-lg-3 py-3 py-lg-4" href="/blog/about.html">About</a>
                </li>
            </ul>
        </div>
    </div>
</nav>


<!-- Page Header -->
<header class="masthead" style="background-image:url('/blog/assets/img/post_backgrounds/HHC2024_background.png')">
    <div class="overlay"></div>
    <div class="container position-relative px-4 px-lg-5">
        <div class="row gx-4 gx-lg-5 justify-content-center">
            <div class="col-md-10 col-lg-8 col-xl-7">
                <div class="site-heading">
                    <h1>SANS Holiday Hack Challenge 2024 Writeup</h1>
                    
                    <h2 class="subheading">Walkthrough</h2>
                    
                    
                    <span class="meta">Posted on January 13, 2025</span>
                    

                </div>
            </div>
        </div>
    </div>
</header>

<!-- Post Content -->
<article>
    <div class="container">

        
        <nav id="sidebar" class="sidebar-wrapper active">
            <div class="sidebar-header">
                <h3>Table of contents</h3>
                <h4>SANS Holiday Hack Challenge 2024 Writeup</h4>
            </div>

            <ul class="list-unstyled components">
                <ul id="toc" class="section-nav">
<li class="toc-entry toc-h1">
<a href="#introduction">Introduction</a>
<ul>
<li class="toc-entry toc-h4"><a href="#first-login-and-intro">First login and intro</a></li>
</ul>
</li>
<li class="toc-entry toc-h1">
<a href="#prologue">Prologue</a>
<ul>
<li class="toc-entry toc-h4"><a href="#first-terminal">First Terminal</a></li>
<li class="toc-entry toc-h2"><a href="#elf-connect">Elf Connect</a></li>
<li class="toc-entry toc-h2"><a href="#elf-minder-9000">Elf Minder 9000</a></li>
</ul>
</li>
<li class="toc-entry toc-h1">
<a href="#act-i">Act I</a>
<ul>
<li class="toc-entry toc-h2"><a href="#curling">cURLing</a></li>
<li class="toc-entry toc-h2"><a href="#frosty-keypad">Frosty Keypad</a></li>
<li class="toc-entry toc-h2"><a href="#shredded-pieces">Shredded Pieces</a></li>
<li class="toc-entry toc-h2">
<a href="#hardware-hacking">Hardware Hacking</a>
<ul>
<li class="toc-entry toc-h4"><a href="#hardware-part-1">Hardware Part 1</a></li>
<li class="toc-entry toc-h4"><a href="#hardware-part-2">Hardware Part 2</a></li>
</ul>
</li>
<li class="toc-entry toc-h2"><a href="#frostys-beach">Frosty’s Beach</a></li>
</ul>
</li>
<li class="toc-entry toc-h1">
<a href="#act-ii">Act II</a>
<ul>
<li class="toc-entry toc-h2"><a href="#toilet-tunnel-network">Toilet Tunnel Network</a></li>
<li class="toc-entry toc-h2"><a href="#mobile-analysis">Mobile Analysis</a></li>
<li class="toc-entry toc-h2"><a href="#snowball-showdown">Snowball Showdown</a></li>
<li class="toc-entry toc-h2"><a href="#drone-path">Drone Path</a></li>
<li class="toc-entry toc-h2"><a href="#powershell">PowerShell</a></li>
<li class="toc-entry toc-h2"><a href="#north-pole-monitor-station">North Pole Monitor Station</a></li>
<li class="toc-entry toc-h2"><a href="#the-great-elf-conflict">The Great Elf Conflict</a></li>
</ul>
</li>
<li class="toc-entry toc-h1">
<a href="#act-iii">Act III</a>
<ul>
<li class="toc-entry toc-h2"><a href="#santa-vision">Santa Vision</a></li>
</ul>
</li>
</ul>
            </ul>

        </nav>
        

        <div class="row">
            <div class="col-lg-8 col-md-10 mx-auto">
                
                <button type="button" id="sidebarCollapse" class="btn btn-primary-sm btn btn-block">
                    <i class="fas fa-align-left"></i>
                    <span>Toggle Table of Contents</span>
                </button>
                
                <br>
                <h1 id="introduction">
<a class="anchor" href="#introduction" aria-hidden="true"><span class="octicon octicon-link"></span></a>Introduction</h1>

<p><strong>TLDR</strong></p>

<blockquote>
  <p>In 2024, the Holiday Hack Challenge is about the elves fighting each other.</p>
</blockquote>

<p>It was a lot of fun again and I hope I can help people with this walkthrough in case they get stuck somewhere.</p>

<h4 id="first-login-and-intro">
<a class="anchor" href="#first-login-and-intro" aria-hidden="true"><span class="octicon octicon-link"></span></a>First login and intro</h4>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241109005944.png" width="100%" alt="figure"></p>

<p>Sign in with Email/Password, Google or X:</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241109010132.png" width="100%" alt="figure"></p>

<p>Click “Play Now!”:</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241109010355.png" width="100%" alt="figure"></p>

<h1 id="prologue">
<a class="anchor" href="#prologue" aria-hidden="true"><span class="octicon octicon-link"></span></a>Prologue</h1>

<p>Goto Jingle Ringford to get the Snowball Badge:</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241109010423.png" width="100%" alt="figure">
<img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241109010455.png" width="100%" alt="figure">
<img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241109010510.png" width="100%" alt="figure">
<img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241109010613.png" width="100%" alt="figure">
<img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241109010633.png" width="100%" alt="figure">
<img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241109010646.png" width="100%" alt="figure"><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241109010818.png" width="100%" alt="figure">
<img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241109010828.png" width="100%" alt="figure"></p>

<p>After we have the snowball badge you can start your first terminal challenge:</p>

<h4 id="first-terminal">
<a class="anchor" href="#first-terminal" aria-hidden="true"><span class="octicon octicon-link"></span></a>First Terminal</h4>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241109010847.png" width="100%" alt="figure">
<img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241109010937.png" width="100%" alt="figure">
<img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241109011004.png" width="100%" alt="figure">
<img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241109011016.png" width="100%" alt="figure">
<img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241109011037.png" width="100%" alt="figure">
<img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241109015823.png" width="100%" alt="figure">
<img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241109011218.png" width="100%" alt="figure"></p>

<p>So from the conversation you now should search for Poinsettia McKittens and Angel Candysalt. Both can be found nearby.</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241109011827.png" width="100%" alt="figure"></p>

<h2 id="elf-connect">
<a class="anchor" href="#elf-connect" aria-hidden="true"><span class="octicon octicon-link"></span></a>Elf Connect</h2>

<p>Talk to Angel Candysalt:</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241109011903.png" width="100%" alt="figure">
<img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241109011955.png" width="100%" alt="figure"></p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241109012038.png" width="100%" alt="figure"></p>

<p>So let’s play connections :)</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241109012121.png" width="100%" alt="figure">
<img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241109012929.png" width="100%" alt="figure">
<img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241109012849.png" width="100%" alt="figure">
<img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241109013225.png" width="100%" alt="figure">
<img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241109013238.png" width="100%" alt="figure">
<img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241109013604.png" width="100%" alt="figure">
<img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241109015039.png" width="100%" alt="figure">
<img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241109015515.png" width="100%" alt="figure"></p>

<p>Angel Candysalt gives some more information to manipulate the score itself in the code.
If you look into the code in the browser you see:</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241109015536.png" width="100%" alt="figure"></p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241109015604.png" width="100%" alt="figure"><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241109020944.png" width="100%" alt="figure"></p>

<p>The score is set based on sessionStorage score. After the first round I tried to change it from 400 to 400000.
But editing it directly in session storage does not work:</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241109021056.png" width="100%" alt="figure"></p>

<p>So the next idea was to set a breakpoint at a line where the score is updated. 
There is a line where a new line connections is awarded with 100 points. So let’s set a breakpoint here:</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241109030956.png" width="100%" alt="figure"></p>

<p>The next time you have a correct line of connections the breakpoint will be triggered and you can set up an arbitrary value:</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241109031008.png" width="100%" alt="figure"></p>

<p>If you now disable all breakpoints and let the program continue you will get the gold level of this challenge:</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241109031019.png" width="100%" alt="figure"></p>

<p>Now let’s search for Poinsettia McMittens:</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241109031054.png" width="100%" alt="figure">
<img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241109023456.png" width="100%" alt="figure">
<img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241109023514.png" width="100%" alt="figure"></p>

<h2 id="elf-minder-9000">
<a class="anchor" href="#elf-minder-9000" aria-hidden="true"><span class="octicon octicon-link"></span></a>Elf Minder 9000</h2>
<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241109011316.png" width="100%" alt="figure"></p>

<p>The following where the solutions I found in the usual way to play Elf Minder 9000:</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241109215147.png" width="100%" alt="figure">
<img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241109220229.png" width="100%" alt="figure">
<img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241109215251.png" width="100%" alt="figure">
<img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241109215330.png" width="100%" alt="figure">
<img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241109215345.png" width="100%" alt="figure">
<img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241109215401.png" width="100%" alt="figure">
<img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241109215419.png" width="100%" alt="figure"></p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241109215434.png" width="100%" alt="figure"></p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241109215453.png" width="100%" alt="figure">
<img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241109215506.png" width="100%" alt="figure"></p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241109215517.png" width="100%" alt="figure">
<img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241109220721.png" width="100%" alt="figure"></p>

<p>After that I tried to find the gold level:</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241109214358.png" width="100%" alt="figure"></p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241109220302.png" width="100%" alt="figure"><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241109220337.png" width="100%" alt="figure">
<img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241218202855.png" width="100%" alt="figure"></p>

<p>If you look into the code you see that there is an edit mode:</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241112001141.png" width="100%" alt="figure"></p>

<p>Data seems to be stored as json:</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241112001653.png" width="100%" alt="figure"></p>

<p>There is also a strange variable named <code class="language-plaintext highlighter-rouge">whyCantIHoldAllTheseThings</code>:</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241112002458.png" width="100%" alt="figure"></p>

<p>And Websockets seems to be used:</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241112011322.png" width="100%" alt="figure"></p>

<p>There is a function <code class="language-plaintext highlighter-rouge">disappointHackers</code>:</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241112011335.png" width="100%" alt="figure"></p>

<p>Looking above the comments mentioning edit there is an interesting variable <code class="language-plaintext highlighter-rouge">isEditor</code>:</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241113012048.png" width="100%" alt="figure">
Double Excalamation marks mean convert to boolean true if not empty</p>

<p><a href="https://hhc24-elfminder.holidayhackchallenge.com/index.html?id=171bcaee-cb15-43de-852d-c987458aacc9&amp;level=A%20Real%20Pickle&amp;edit=true" target="_blank" rel="noopener noreferrer">
https://hhc24-elfminder.holidayhackchallenge.com/index.html?id=171bcaee-cb15-43de-852d-c987458aacc9&amp;level=A%20Real%20Pickle&amp;edit=true
</a> goes in the edit mode</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241218211427.png" width="100%" alt="figure">
<img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241113012353.png" width="100%" alt="figure"></p>

<p>This could lead to something like:</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241218211457.png" width="100%" alt="figure"></p>

<p>But you cannot end this level.</p>

<p>The game is based on json:</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241113013107.png" width="100%" alt="figure">
<img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241113013310.png" width="100%" alt="figure">
<img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241113013417.png" width="100%" alt="figure"></p>

<p>But I haven’t found out how I can use this to solve the gold challenge.</p>

<h1 id="act-i">
<a class="anchor" href="#act-i" aria-hidden="true"><span class="octicon octicon-link"></span></a>Act I</h1>

<p>In your snowball click to go to Act I:</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241117192220.png" width="100%" alt="figure">
<img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241117192311.png" width="100%" alt="figure"></p>

<h2 id="curling">
<a class="anchor" href="#curling" aria-hidden="true"><span class="octicon octicon-link"></span></a>cURLing</h2>

<p>On of the first places you find is:</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241117192422.png" width="100%" alt="figure"></p>

<p>Bow Ninecandle introduces you to the task:</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241117192443.png" width="100%" alt="figure">
<img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241117192537.png" width="100%" alt="figure">
<img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241117192651.png" width="100%" alt="figure"></p>

<p>Possible solutions are:</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241117192733.png" width="100%" alt="figure">
<img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241117192744.png" width="100%" alt="figure"></p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>y
</code></pre></div></div>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241117192802.png" width="100%" alt="figure">
<img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241117193020.png" width="100%" alt="figure"></p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>curl curlingfun:8080 -&gt; 
<span class="s2">"""
You have successfully accessed the site on port 8080!

If you need help, please remember to run "</span>hint<span class="s2">" for a hint!
"""</span>
</code></pre></div></div>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241117193217.png" width="100%" alt="figure"></p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>curl <span class="nt">-k</span> https://curlingfun:9090
</code></pre></div></div>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241117195806.png" width="100%" alt="figure"></p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>curl <span class="nt">-X</span> POST <span class="nt">-d</span> <span class="s2">"skip=alabaster"</span> <span class="nt">-k</span> https://curlingfun:9090
</code></pre></div></div>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241117195828.png" width="100%" alt="figure"></p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>curl <span class="nt">--cookie</span> <span class="s2">"end=3"</span> <span class="nt">-k</span> https://curlingfun:9090
</code></pre></div></div>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241117200123.png" width="100%" alt="figure"></p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>curl <span class="nt">-I</span> <span class="nt">-k</span> https://curlingfun:9090
</code></pre></div></div>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241117200316.png" width="100%" alt="figure"></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>curl -H "Stone:Granite" -k https://curlingfun:9090
</code></pre></div></div>
<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241117200639.png" width="100%" alt="figure"></p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>curl <span class="nt">-k</span> <span class="nt">--path-as-is</span>  <span class="s1">'https://curlingfun:9090/../../etc/hacks'</span>
</code></pre></div></div>
<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241117200737.png" width="100%" alt="figure"></p>

<p>Look into the folder:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">ls</span> 
</code></pre></div></div>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241117200813.png" width="100%" alt="figure"></p>

<p>There is a file explaining hard mode:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">cat </span>HARD-MODE.txt
</code></pre></div></div>

<p>To solve these constraints run:</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241117200844.png" width="100%" alt="figure">
<img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241117201218.png" width="100%" alt="figure"></p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>curl <span class="nt">-H</span> <span class="s2">"Hack:12ft"</span> <span class="nt">--cookie</span> <span class="s2">"end=10"</span> <span class="nt">-X</span> POST <span class="nt">-d</span> <span class="s2">"skip=bow"</span> <span class="nt">-k</span> https://curlingfun:9090
</code></pre></div></div>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241117201441.png" width="100%" alt="figure"></p>

<p>Ok then access this URL:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>curl <span class="nt">-H</span> <span class="s2">"Hack:12ft"</span> <span class="nt">--cookie</span> <span class="s2">"end=10"</span> <span class="nt">-X</span> POST <span class="nt">-d</span> <span class="s2">"skip=bow"</span> <span class="nt">-k</span> <span class="nt">--path-as-is</span> <span class="s1">'https://curlingfun:9090/../../etc/button'</span>
</code></pre></div></div>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241117201555.png" width="100%" alt="figure"></p>

<p>Finally follow the redirection with <code class="language-plaintext highlighter-rouge">-L</code>:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>curl <span class="nt">-L</span> <span class="nt">-H</span> <span class="s2">"Hack:12ft"</span> <span class="nt">--cookie</span> <span class="s2">"end=10"</span> <span class="nt">-X</span> POST <span class="nt">-d</span> <span class="s2">"skip=bow"</span> <span class="nt">-k</span> <span class="nt">--path-as-is</span> <span class="s1">'https://curlingfun:9090/GoodSportsmanship'</span>
</code></pre></div></div>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241117201724.png" width="100%" alt="figure"></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>"""
Excellent work, you have solved hard mode!  You may close this terminal once HHC grants your achievement.
"""
</code></pre></div></div>

<p>After the challenge is solved perhaps Bow Ninecandle tells you a little bit additional:</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241117203039.png" width="100%" alt="figure">
<img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241117203201.png" width="100%" alt="figure">
<img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241117203217.png" width="100%" alt="figure"></p>

<p>The next I visited was Alabaster Snowball left to the curling area:</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241117203324.png" width="100%" alt="figure"></p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241117203635.png" width="100%" alt="figure">
<img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241117203709.png" width="100%" alt="figure"></p>

<p>At the left of this area is Tinsel Upatree:</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241117205135.png" width="100%" alt="figure">
<img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241117205413.png" width="100%" alt="figure">
So this probably gives the hint to look into the crates.</p>

<p>A little bit lower at the left side is Noel Boetie:</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241117205641.png" width="100%" alt="figure">
<img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241117210015.png" width="100%" alt="figure"></p>

<p>There is a monitoring station in the middle:</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241117210123.png" width="100%" alt="figure">
<img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241117210136.png" width="100%" alt="figure">
<img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241117210242.png" width="100%" alt="figure">
<img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241121233055.png" width="100%" alt="figure"></p>

<h2 id="frosty-keypad">
<a class="anchor" href="#frosty-keypad" aria-hidden="true"><span class="octicon octicon-link"></span></a>Frosty Keypad</h2>

<p>Right at the top you can find Morcel Nougat and a keypad challenge:</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241121010232.png" width="100%" alt="figure">
<img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241121234507.png" width="100%" alt="figure">
<img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241121010513.png" width="100%" alt="figure">
<img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241121010540.png" width="100%" alt="figure">
<img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241121010647.png" width="100%" alt="figure">
<img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241121010659.png" width="100%" alt="figure"></p>

<p>The book can be found here:</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241121010753.png" width="100%" alt="figure">
<img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241121010856.png" width="100%" alt="figure"></p>

<p>And there is a UV flashlight:</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241122002222.png" width="100%" alt="figure"></p>

<p>The book contains the following text:</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241121011415.png" width="100%" alt="figure">
<img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241121011439.png" width="100%" alt="figure">
<img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241121011931.png" width="100%" alt="figure">
<img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241121011945.png" width="100%" alt="figure"></p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241121012055.png" width="100%" alt="figure">
<img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241121012217.png" width="100%" alt="figure"></p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241121012245.png" width="100%" alt="figure"></p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241121012346.png" width="100%" alt="figure"></p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241121012401.png" width="100%" alt="figure"></p>

<p>To proceed you can read about the Ottendorf Cipher: <a href="https://nationaltreasure.fandom.com/wiki/Ottendorf_Cipher" target="_blank" rel="noopener noreferrer">https://nationaltreasure.fandom.com/wiki/Ottendorf_Cipher</a></p>

<p>There is a hint at the postit at left upper side:</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241121012516.png" width="100%" alt="figure">
<img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241122000905.png" width="100%" alt="figure"></p>

<p>So from the Ottendorf cipher this is the combination “Page:Word:Character in Word” which results in</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>SANTA
</code></pre></div></div>

<p>With the UV flash light you can identify the numbers used. This can narrow the set to find the combination of numbers.</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241122002259.png" width="100%" alt="figure">
<img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241122002321.png" width="100%" alt="figure">
<img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241122002335.png" width="100%" alt="figure">
<img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241122002353.png" width="100%" alt="figure">
<img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241122002404.png" width="100%" alt="figure">
<img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241122002440.png" width="100%" alt="figure"></p>

<p>The numbers are 2,6,7 and 8.</p>

<p>What could the word <code class="language-plaintext highlighter-rouge">SANTA</code> be in numbers? 
I found the solution at the mobile phone - <a href="https://en.wikipedia.org/wiki/T9_(predictive_text)" target="_blank" rel="noopener noreferrer">T9</a>:</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241206203238.png" width="100%" alt="figure"></p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241122005001.png" width="100%" alt="figure"></p>

<p>Now let’s try to permutate 2,6, 7 and 8, brute force the key pad and find the gold solution.
I took the HTTP request from the web site put it into python using the requests library. 
You have to toggle the speed a bit to get correct solution in the responses. I took 1 second:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="n">requests</span>
<span class="kn">import</span> <span class="n">time</span>
<span class="kn">from</span> <span class="n">itertools</span> <span class="kn">import</span> <span class="n">product</span>

<span class="k">def</span> <span class="nf">submit_answer</span><span class="p">(</span><span class="n">answer</span><span class="p">):</span>
    <span class="c1"># Define the URL, headers, and data
</span>    <span class="c1"># url = "https://hhc24-frostykeypad.holidayhackchallenge.com/submit?id=c5e47b3c-3816-4a83-81e2-d76d6be16286"
</span>    <span class="n">url</span> <span class="o">=</span> <span class="sh">"</span><span class="s">https://hhc24-frostykeypad.holidayhackchallenge.com/submit?id=b973b6b2-ab9f-43a4-8554-7bad47c15195</span><span class="sh">"</span>
    <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
        <span class="sh">"</span><span class="s">User-Agent</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">&lt;your User Agent&gt;</span><span class="sh">"</span><span class="p">,</span>
        <span class="sh">"</span><span class="s">Accept</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">*/*</span><span class="sh">"</span><span class="p">,</span>
        <span class="sh">"</span><span class="s">Accept-Language</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">de,en-US;q=0.7,en;q=0.3</span><span class="sh">"</span><span class="p">,</span>
        <span class="sh">"</span><span class="s">Accept-Encoding</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">gzip, deflate, br, zstd</span><span class="sh">"</span><span class="p">,</span>
        <span class="sh">"</span><span class="s">Referer</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">https://hhc24-frostykeypad.holidayhackchallenge.com/?&amp;challenge=termFrostyKeypad&amp;username=IeFeec2e&amp;id=b973b6b2-ab9f-43a4-8554-7bad47c15195&amp;area=frontyardact1&amp;location=62,22&amp;tokens=easy,termFrostyKeypad,hard&amp;dna=ATATATTAATATATATATATTACGATATATATTATAGCATATATATATATATTAGCATATATATATATGCCGATATTATAATATATATATATGCGCATATATATATATATCGATATTACG</span><span class="sh">"</span><span class="p">,</span>
        <span class="c1">#"Referer": "https://hhc24-frostykeypad.holidayhackchallenge.com/?&amp;challenge=termFrostyKeypad&amp;username=IeFeec2e&amp;id=c5e47b3c-3816-4a83-81e2-d76d6be16286&amp;area=frontyardact1&amp;location=62,23&amp;tokens=&amp;dna=ATATATTAATATATATATATTACGATATATATTATAGCATATATATATATATTAGCATATATATATATGCCGATATTATAATATATATATATGCGCATATATATATATATCGATATTACG",
</span>        <span class="sh">"</span><span class="s">Content-Type</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">application/json</span><span class="sh">"</span><span class="p">,</span>
        <span class="sh">"</span><span class="s">Origin</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">https://hhc24-frostykeypad.holidayhackchallenge.com</span><span class="sh">"</span><span class="p">,</span>
        <span class="sh">"</span><span class="s">Alt-Used</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">hhc24-frostykeypad.holidayhackchallenge.com</span><span class="sh">"</span><span class="p">,</span>
        <span class="sh">"</span><span class="s">Connection</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">keep-alive</span><span class="sh">"</span><span class="p">,</span>
        <span class="sh">"</span><span class="s">Cookie</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">CreativeCookieName=eyJ1c2VyaWQiOiI1NzgxYjBkMi02YTdjLTRjNTEtYWZlZS0zMmVkZmUxODVmNmEifQ.Z1I3Qg.iRNJPtIXeYJt9XFndzErrrNeiOE</span><span class="sh">"</span><span class="p">,</span>
        <span class="c1">#"Cookie": "CreativeCookieName=eyJ1c2VyaWQiOiIwODlmY2MwNS04ZmI2LTRmNDctODc0Ni01OThiYzVhOWEwNDAifQ.Zz594g._3M5KLOrZW-wLC6ilcHuGEoUM5k",
</span>        <span class="sh">"</span><span class="s">Sec-Fetch-Dest</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">empty</span><span class="sh">"</span><span class="p">,</span>
        <span class="sh">"</span><span class="s">Sec-Fetch-Mode</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">cors</span><span class="sh">"</span><span class="p">,</span>
        <span class="sh">"</span><span class="s">Sec-Fetch-Site</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">same-origin</span><span class="sh">"</span><span class="p">,</span>
        <span class="sh">"</span><span class="s">DNT</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">1</span><span class="sh">"</span><span class="p">,</span>
        <span class="sh">"</span><span class="s">Sec-GPC</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">1</span><span class="sh">"</span><span class="p">,</span>
        <span class="sh">"</span><span class="s">Priority</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">u=0</span><span class="sh">"</span><span class="p">,</span>
        <span class="sh">"</span><span class="s">TE</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">trailers</span><span class="sh">"</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="sh">"</span><span class="s">answer</span><span class="sh">"</span><span class="p">:</span> <span class="n">answer</span><span class="p">}</span>  <span class="c1"># Replace with your actual answer
</span>
    <span class="c1"># Send the POST request
</span>    <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="nf">post</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">,</span> <span class="n">json</span><span class="o">=</span><span class="n">data</span><span class="p">)</span>
    <span class="n">time</span><span class="p">.</span><span class="nf">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

    <span class="c1"># Print the response status code
</span>    <span class="nf">print</span><span class="p">(</span><span class="n">answer</span><span class="o">+</span> <span class="sh">"</span><span class="s"> </span><span class="sh">"</span><span class="o">+</span> <span class="nf">str</span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="n">status_code</span><span class="p">))</span>

    <span class="c1"># If successful (status code 200), you can print the response content
</span>    <span class="c1"># if response.status_code == 200:
</span>    <span class="c1">#    print(response.text)
</span>
<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="sh">"</span><span class="s">__main__</span><span class="sh">"</span><span class="p">:</span>
    <span class="c1"># Loop through potential answers (replace 100000 with the desired upper limit)
</span>    <span class="k">for</span> <span class="n">combo</span> <span class="ow">in</span> <span class="nf">product</span><span class="p">(</span><span class="sh">'</span><span class="s">2678</span><span class="sh">'</span><span class="p">,</span> <span class="n">repeat</span><span class="o">=</span><span class="mi">5</span><span class="p">):</span>
    <span class="c1">#for combo in product('8039', repeat=5):
</span>    <span class="c1">#for combo in product('9140', repeat=5):
</span>        <span class="nf">submit_answer</span><span class="p">(</span><span class="sh">''</span><span class="p">.</span><span class="nf">join</span><span class="p">(</span><span class="n">combo</span><span class="p">))</span>
</code></pre></div></div>

<p>This yields in a lot of 400 HTTP Status Codes:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>400
<span class="o">{</span><span class="s2">"error"</span>:<span class="s2">"The data you've provided seems to have gone on a whimsical adventure, losing all sense of order and coherence!"</span><span class="o">}</span>
</code></pre></div></div>

<p>and finally to:</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241122004907.png" width="100%" alt="figure">
If you grep in the output:
<img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241122010934.png" width="100%" alt="figure">
you have the gold solution! :)
<img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241122011032.png" width="100%" alt="figure">
So the first answer is from the word <code class="language-plaintext highlighter-rouge">SANTA</code> at the Keypad:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>72682
</code></pre></div></div>

<p>and by using brute force:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>22786
</code></pre></div></div>

<h2 id="shredded-pieces">
<a class="anchor" href="#shredded-pieces" aria-hidden="true"><span class="octicon octicon-link"></span></a>Shredded Pieces</h2>

<p>If you talk to Morcel Nougat again</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241122005039.png" width="100%" alt="figure"></p>

<p>you get shredded pieces</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241122005116.png" width="100%" alt="figure">
<img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241122005154.png" width="100%" alt="figure">
The whole text from Morcel:
<img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241206222624.png" width="100%" alt="figure"></p>

<p>and you have a new item in your pocket:</p>

<p><img src="/blog/assets/img/hhc/2024/shredded_pieces_item.png" width="100%" alt="figure"></p>

<p>Morcel Nougat has a hint for you:
<img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241206222724.png" width="100%" alt="figure"></p>

<p>as well as Jewel Loggins:
<img src="/blog/assets/img/hhc/2024/shredded_pieces.png" width="100%" alt="figure"></p>

<p>So let’s use the mentioned github gist <a href="https://gist.github.com/arnydo/5dc85343eca9b8eb98a0f157b9d4d719" target="_blank" rel="noopener noreferrer">https://gist.github.com/arnydo/5dc85343eca9b8eb98a0f157b9d4d719</a>:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">mkdir </span>shredded_pieces
<span class="nb">cd </span>shredded_pieces
<span class="nb">mv</span> ~/Downloads/shreds.zip <span class="nb">.</span>
curl <span class="nt">-LO</span> https://gist.githubusercontent.com/arnydo/5dc85343eca9b8eb98a0f157b9d4d719/raw/78aa80e7fcead23fdd7f890b466a5f00ad956b7d/heuristic_edge_detection.py 
unzip shreds.zip
<span class="nb">sudo </span>apt <span class="nb">install </span>python3-numpy

</code></pre></div></div>

<p>After that you can use <code class="language-plaintext highlighter-rouge">python3 heuristic_edge_detection.py</code> and as a result get <code class="language-plaintext highlighter-rouge">assembled_image.png</code>:</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241206222146.png" width="100%" alt="figure"></p>

<p>From the picture you can extract:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>BAUD: 112500
PARITY: EVEN
DATA: 7 BITS
STOP BITS: 1 BIT
FLOW CONTROL: RTS
</code></pre></div></div>

<h2 id="hardware-hacking">
<a class="anchor" href="#hardware-hacking" aria-hidden="true"><span class="octicon octicon-link"></span></a>Hardware Hacking</h2>

<p>At the right side there is a hardware hacking challenge with Jewel Loggins:</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241117210742.png" width="100%" alt="figure">
<img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241117210838.png" width="100%" alt="figure">
<img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241117210908.png" width="100%" alt="figure"></p>

<p>There is also Wombley Cube a little bit more above:</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241117211036.png" width="100%" alt="figure">
<img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241117211152.png" width="100%" alt="figure"></p>

<h4 id="hardware-part-1">
<a class="anchor" href="#hardware-part-1" aria-hidden="true"><span class="octicon octicon-link"></span></a>Hardware Part 1</h4>

<p>Let’s tackle the hardware challenge:</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241121014019.png" width="100%" alt="figure"></p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241121223514.png" width="100%" alt="figure"></p>

<p>With the information from shredded pieces you can piece together the shreds and the configuration (cf <a href="#shredded-pieces"><strong>shredded pieces</strong></a>)</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>BAUD: 115200
PARITY: EVEN
DATA: 7 BITS
STOP BITS: 1 BIT
FLOW CONTROL: RTS
</code></pre></div></div>

<p>I used the AI which responded to the colors with:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">**</span>Frequently used color assignments:<span class="k">**</span>

- Red:<span class="k">**</span> Often used <span class="k">for </span>the positive supply voltage <span class="o">(</span>VCC<span class="o">)</span><span class="nb">.</span>
- Black:<span class="k">**</span> Usually used <span class="k">for </span>ground <span class="o">(</span>GND<span class="o">)</span><span class="nb">.</span>
- Green:<span class="k">**</span> Often used <span class="k">for </span>the TX <span class="o">(</span>Transmit<span class="o">)</span> pin.
- Blue:<span class="k">**</span> Often used <span class="k">for </span>the RX <span class="o">(</span>Receive<span class="o">)</span> pin.
- White:<span class="k">**</span> Can be used <span class="k">for </span>various signals, but is less common than the other colors.
</code></pre></div></div>

<p>and therefore set TX to RX and RX to TX with the corresponding colors.</p>

<p>With the aforementioned settings it burned the chip:</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241206233244.png" width="100%" alt="figure"></p>

<p>So change 5V to 3V. After that it works:</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241206233223.png" width="100%" alt="figure"></p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241206233148.png" width="100%" alt="figure"></p>

<p>Now Jewel Loggins tells you a little bit more</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241206233354.png" width="100%" alt="figure">
<img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241206233618.png" width="100%" alt="figure">
<img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241206233712.png" width="100%" alt="figure"></p>

<h4 id="hardware-part-2">
<a class="anchor" href="#hardware-part-2" aria-hidden="true"><span class="octicon octicon-link"></span></a>Hardware Part 2</h4>

<p>Let us now turn to the left-hand side “Hardware Part 2”</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241206234040.png" width="100%" alt="figure"></p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241206234822.png" width="100%" alt="figure"></p>

<p>If you check the folder and look into the bash history you can find the following</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241206235437.png" width="100%" alt="figure"></p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>slh <span class="nt">--passcode</span> CandyCaneCrunch77 <span class="nt">--set-access</span> 1 <span class="nt">--id</span> 42
</code></pre></div></div>

<p>Lets use that to grant access to card number 42</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241206235515.png" width="100%" alt="figure"></p>

<p>Jewel Loggins now gives you a hint for gold</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241206235706.png" width="100%" alt="figure">
<img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241206235735.png" width="100%" alt="figure">
<img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241224013008.png" width="100%" alt="figure"></p>

<p>So let’s relogin to the shell. If you look into the folder you can find a file <code class="language-plaintext highlighter-rouge">access_cards</code> which is an sqlite database</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241224013231.png" width="100%" alt="figure">
<img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241224013351.png" width="100%" alt="figure"></p>

<p>It has two tables <code class="language-plaintext highlighter-rouge">access_cards</code> and <code class="language-plaintext highlighter-rouge">config</code>. What is inside the <code class="language-plaintext highlighter-rouge">access_cards</code> table</p>

<pre><code class="language-sqlite">select * from access_cards 
</code></pre>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241224013458.png" width="100%" alt="figure"></p>

<p>Card ID 42 has the following data</p>

<pre><code class="language-sqlite">sqlite&gt; select * from access_cards where id=42;
42|c06018b6-5e80-4395-ab71-ae5124560189|0|ecb9de15a057305e5887502d46d434c9394f5ed7ef1a51d2930ad786b02f6ffd
</code></pre>

<p>Let’s take a short glimpse into the <code class="language-plaintext highlighter-rouge">config</code> table</p>

<pre><code class="language-sqlite">sqlite&gt; select * from config;
1|hmac_secret|9ed1515819dec61fd361d5fdabb57f41ecce1a5fe1fe263b98c0d6943b9b232e
2|hmac_message_format|{access}{uuid}
3|admin_password|3a40ae3f3fd57b2a4513cca783609589dbe51ce5e69739a33141c5717c20c9c1
4|app_version|1.0
</code></pre>

<p>The signature from card id 42 is most probably SHA2-256</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241224020031.png" width="100%" alt="figure"></p>

<p>The format for the hmac message format from the <code class="language-plaintext highlighter-rouge">config</code> table says</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>{access}{uuid}
</code></pre></div></div>

<p>From this format and the hint from Jewel Loggins to CyberChef, let’s try to create the HMAC.</p>

<p>Open CyberChef and search in the left upper corner in the search box for “HMAC” and move it in the recipe panel. Then write in the input panel (according to
{access}{uuid} - uuid is the second row in the <code class="language-plaintext highlighter-rouge">access_cards</code> table). 
Set key format to UTF-8 and the key to the HMAC secret found from the <code class="language-plaintext highlighter-rouge">config</code> table.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>1c06018b6-5e80-4395-ab71-ae5124560189
</code></pre></div></div>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241224021159.png" width="100%" alt="figure"></p>

<p>The result is the missing signature which can be used to update the card number 42:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>135a32d5026c5628b1753e6c67015c0f04e26051ef7391c2552de2816b1b7096
</code></pre></div></div>

<pre><code class="language-sqlite">UPDATE access_cards
SET 
id=42,
uuid='c06018b6-5e80-4395-ab71-ae5124560189', 
access=1,
sig='135a32d5026c5628b1753e6c67015c0f04e26051ef7391c2552de2816b1b7096'
WHERE id = 42;
</code></pre>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241224021331.png" width="100%" alt="figure">
Jewel Loggins tells nothing new after that.</p>

<p>Alabaster Snowball:
<img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241207000106.png" width="100%" alt="figure">
<img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241207000132.png" width="100%" alt="figure">
Wombley Cube:
<img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241207000628.png" width="100%" alt="figure"></p>

<h2 id="frostys-beach">
<a class="anchor" href="#frostys-beach" aria-hidden="true"><span class="octicon octicon-link"></span></a>Frosty’s Beach</h2>

<p>There is some stuff going on at Frosty’s Beach the context of which I have not yet understood:</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241121005511.png" width="100%" alt="figure">
<img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241121005522.png" width="100%" alt="figure">
<img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241121005654.png" width="100%" alt="figure"></p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241121005743.png" width="100%" alt="figure">
<img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241121005804.png" width="100%" alt="figure">
<img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241121005830.png" width="100%" alt="figure"></p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241121005850.png" width="100%" alt="figure"></p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241121005917.png" width="100%" alt="figure">
<img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241121005934.png" width="100%" alt="figure"></p>

<h1 id="act-ii">
<a class="anchor" href="#act-ii" aria-hidden="true"><span class="octicon octicon-link"></span></a>Act II</h1>

<p>If you enter Act II the following will happen</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241207001458.png" width="100%" alt="figure"></p>

<p>Alabaster Snowball gives you a bit information about what happened</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241207221800.png" width="100%" alt="figure">
<img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241207221919.png" width="100%" alt="figure"></p>

<h2 id="toilet-tunnel-network">
<a class="anchor" href="#toilet-tunnel-network" aria-hidden="true"><span class="octicon octicon-link"></span></a>Toilet Tunnel Network</h2>

<p>Sparkle Redberry tells you about some hidden tunnel which you can probably use</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241207221943.png" width="100%" alt="figure">
<img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241207222138.png" width="100%" alt="figure"></p>

<p>You can those hidden tunnel in small toilets which you then can use as tunnel between Alabaster area, Wombley and a DMZ</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241215011227.png" width="100%" alt="figure">
<img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241215011254.png" width="100%" alt="figure"></p>

<h2 id="mobile-analysis">
<a class="anchor" href="#mobile-analysis" aria-hidden="true"><span class="octicon octicon-link"></span></a>Mobile Analysis</h2>

<p>The first you can talk to Eve Snowshoes who opens a new task</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241207123946.png" width="100%" alt="figure">
<img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241207124010.png" width="100%" alt="figure">
<img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241207124027.png" width="100%" alt="figure">
<img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241213195341.png" width="100%" alt="figure">
<img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241207124138.png" width="100%" alt="figure"></p>

<p>Eve gives you two hints</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241207124255.png" width="100%" alt="figure">
<img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241207124311.png" width="100%" alt="figure"></p>

<p>This is the debug version</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241207124459.png" width="100%" alt="figure"></p>

<p>and this the release</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241207124517.png" width="100%" alt="figure"></p>

<p>If you open <code class="language-plaintext highlighter-rouge">SantaSwipe.apk</code> with Genymotion you can see</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241212002410.png" width="100%" alt="figure"></p>

<p>Install jadx and start the gui</p>

<p><img src="/blog/assets/img/hhc/2024/mobile_analysis_jadx_start.png" width="100%" alt="figure"></p>

<p><code class="language-plaintext highlighter-rouge">SantaSwipe.apk</code> with JADX-GUI reveals a database in the code</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241207204427.png" width="100%" alt="figure"></p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="nc">String</span> <span class="no">DATABASE_NAME</span> <span class="o">=</span> <span class="s">"naughtynicelist.db"</span><span class="o">;</span>  
    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">int</span> <span class="no">DATABASE_VERSION</span> <span class="o">=</span> <span class="mi">3</span><span class="o">;</span>  
  
    <span class="cm">/* JADX WARN: 'super' call moved to the top of the method (can break code semantics) */</span>  
    <span class="kd">public</span> <span class="nf">DatabaseHelper</span><span class="o">(</span><span class="nc">Context</span> <span class="n">context</span><span class="o">)</span> <span class="o">{</span>  
        <span class="kd">super</span><span class="o">(</span><span class="n">context</span><span class="o">,</span> <span class="no">DATABASE_NAME</span><span class="o">,</span> <span class="o">(</span><span class="nc">SQLiteDatabase</span><span class="o">.</span><span class="na">CursorFactory</span><span class="o">)</span> <span class="kc">null</span><span class="o">,</span> <span class="mi">3</span><span class="o">);</span>  
        <span class="nc">Intrinsics</span><span class="o">.</span><span class="na">checkNotNullParameter</span><span class="o">(</span><span class="n">context</span><span class="o">,</span> <span class="s">"context"</span><span class="o">);</span>  
    <span class="o">}</span>  
  
    <span class="nd">@Override</span> <span class="c1">// android.database.sqlite.SQLiteOpenHelper  </span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onCreate</span><span class="o">(</span><span class="nc">SQLiteDatabase</span> <span class="n">db</span><span class="o">)</span> <span class="o">{</span>  
        <span class="nc">Intrinsics</span><span class="o">.</span><span class="na">checkNotNullParameter</span><span class="o">(</span><span class="n">db</span><span class="o">,</span> <span class="s">"db"</span><span class="o">);</span>  
        <span class="n">db</span><span class="o">.</span><span class="na">execSQL</span><span class="o">(</span><span class="s">"CREATE TABLE IF NOT EXISTS NiceList (Item TEXT);"</span><span class="o">);</span>  
        <span class="n">db</span><span class="o">.</span><span class="na">execSQL</span><span class="o">(</span><span class="s">"CREATE TABLE IF NOT EXISTS NaughtyList (Item TEXT);"</span><span class="o">);</span>  
        <span class="n">db</span><span class="o">.</span><span class="na">execSQL</span><span class="o">(</span><span class="s">"CREATE TABLE IF NOT EXISTS NormalList (Item TEXT);"</span><span class="o">);</span>  
        <span class="n">db</span><span class="o">.</span><span class="na">execSQL</span><span class="o">(</span><span class="s">"DELETE FROM NiceList;"</span><span class="o">);</span>  
        <span class="n">db</span><span class="o">.</span><span class="na">execSQL</span><span class="o">(</span><span class="s">"DELETE FROM NaughtyList;"</span><span class="o">);</span>  
        <span class="n">db</span><span class="o">.</span><span class="na">execSQL</span><span class="o">(</span><span class="s">"DELETE FROM NormalList;"</span><span class="o">);</span>  
        <span class="n">db</span><span class="o">.</span><span class="na">execSQL</span><span class="o">(</span><span class="s">"INSERT INTO NormalList (Item) VALUES ('Carlos, Madrid, Spain');"</span><span class="o">);</span>  
        <span class="n">db</span><span class="o">.</span><span class="na">execSQL</span><span class="o">(</span><span class="s">"INSERT INTO NormalList (Item) VALUES ('Aiko, Tokyo, Japan');"</span><span class="o">);</span>  
        <span class="n">db</span><span class="o">.</span><span class="na">execSQL</span><span class="o">(</span><span class="s">"INSERT INTO NormalList (Item) VALUES ('Maria, Rio de Janeiro, Brazil');"</span><span class="o">);</span>  
        <span class="n">db</span><span class="o">.</span><span class="na">execSQL</span><span class="o">(</span><span class="s">"INSERT INTO NormalList (Item) VALUES ('Liam, Dublin, Ireland');"</span><span class="o">);</span>  
        <span class="n">db</span><span class="o">.</span><span class="na">execSQL</span><span class="o">(</span><span class="s">"INSERT INTO NormalList (Item) VALUES ('Emma, New York, USA');"</span><span class="o">);</span>  
        <span class="n">db</span><span class="o">.</span><span class="na">execSQL</span><span class="o">(</span><span class="s">"INSERT INTO NormalList (Item) VALUES ('Chen, Beijing, China');"</span><span class="o">);</span>  
        <span class="n">db</span><span class="o">.</span><span class="na">execSQL</span><span class="o">(</span><span class="s">"INSERT INTO NormalList (Item) VALUES ('Fatima, Casablanca, Morocco');"</span><span class="o">);</span>  
        <span class="n">db</span><span class="o">.</span><span class="na">execSQL</span><span class="o">(</span><span class="s">"INSERT INTO NormalList (Item) VALUES ('Hans, Berlin, Germany');"</span><span class="o">);</span>  
        <span class="n">db</span><span class="o">.</span><span class="na">execSQL</span><span class="o">(</span><span class="s">"INSERT INTO NormalList (Item) VALUES ('Olga, Moscow, Russia');"</span><span class="o">);</span>  
        <span class="n">db</span><span class="o">.</span><span class="na">execSQL</span><span class="o">(</span><span class="s">"INSERT INTO NormalList (Item) VALUES ('Ravi, Mumbai, India');"</span><span class="o">);</span>  
        <span class="n">db</span><span class="o">.</span><span class="na">execSQL</span><span class="o">(</span><span class="s">"INSERT INTO NormalList (Item) VALUES ('Amelia, Sydney, Australia');"</span><span class="o">);</span>  
        <span class="n">db</span><span class="o">.</span><span class="na">execSQL</span><span class="o">(</span><span class="s">"INSERT INTO NormalList (Item) VALUES ('Juan, Buenos Aires, Argentina');"</span><span class="o">);</span>  
        <span class="n">db</span><span class="o">.</span><span class="na">execSQL</span><span class="o">(</span><span class="s">"INSERT INTO NormalList (Item) VALUES ('Sofia, Rome, Italy');"</span><span class="o">);</span>  
        <span class="n">db</span><span class="o">.</span><span class="na">execSQL</span><span class="o">(</span><span class="s">"INSERT INTO NormalList (Item) VALUES ('Ahmed, Cairo, Egypt');"</span><span class="o">);</span>  
        <span class="n">db</span><span class="o">.</span><span class="na">execSQL</span><span class="o">(</span><span class="s">"INSERT INTO NormalList (Item) VALUES ('Yuna, Seoul, South Korea');"</span><span class="o">);</span>  
        <span class="n">db</span><span class="o">.</span><span class="na">execSQL</span><span class="o">(</span><span class="s">"INSERT INTO NormalList (Item) VALUES ('Ellie, Alabama, USA');"</span><span class="o">);</span>  
        <span class="n">db</span><span class="o">.</span><span class="na">execSQL</span><span class="o">(</span><span class="s">"INSERT INTO NormalList (Item) VALUES ('Lucas, Paris, France');"</span><span class="o">);</span>  
        <span class="n">db</span><span class="o">.</span><span class="na">execSQL</span><span class="o">(</span><span class="s">"INSERT INTO NormalList (Item) VALUES ('Mia, Toronto, Canada');"</span><span class="o">);</span>  
        <span class="n">db</span><span class="o">.</span><span class="na">execSQL</span><span class="o">(</span><span class="s">"INSERT INTO NormalList (Item) VALUES ('Sara, Stockholm, Sweden');"</span><span class="o">);</span>  
        <span class="n">db</span><span class="o">.</span><span class="na">execSQL</span><span class="o">(</span><span class="s">"INSERT INTO NormalList (Item) VALUES ('Ali, Tehran, Iran');"</span><span class="o">);</span>  
        <span class="n">db</span><span class="o">.</span><span class="na">execSQL</span><span class="o">(</span><span class="s">"INSERT INTO NormalList (Item) VALUES ('Nina, Lima, Peru');"</span><span class="o">);</span>  
        <span class="n">db</span><span class="o">.</span><span class="na">execSQL</span><span class="o">(</span><span class="s">"INSERT INTO NormalList (Item) VALUES ('Anna, Vienna, Austria');"</span><span class="o">);</span>  
        <span class="n">db</span><span class="o">.</span><span class="na">execSQL</span><span class="o">(</span><span class="s">"INSERT INTO NormalList (Item) VALUES ('Leo, Helsinki, Finland');"</span><span class="o">);</span>  
        <span class="n">db</span><span class="o">.</span><span class="na">execSQL</span><span class="o">(</span><span class="s">"INSERT INTO NormalList (Item) VALUES ('Elena, Athens, Greece');"</span><span class="o">);</span>  
        <span class="n">db</span><span class="o">.</span><span class="na">execSQL</span><span class="o">(</span><span class="s">"INSERT INTO NormalList (Item) VALUES ('Davi, Sao Paulo, Brazil');"</span><span class="o">);</span>  
        <span class="n">db</span><span class="o">.</span><span class="na">execSQL</span><span class="o">(</span><span class="s">"INSERT INTO NormalList (Item) VALUES ('Marta, Warsaw, Poland');"</span><span class="o">);</span>  
        <span class="n">db</span><span class="o">.</span><span class="na">execSQL</span><span class="o">(</span><span class="s">"INSERT INTO NormalList (Item) VALUES ('Noah, Zurich, Switzerland');"</span><span class="o">);</span>  
        <span class="n">db</span><span class="o">.</span><span class="na">execSQL</span><span class="o">(</span><span class="s">"INSERT INTO NormalList (Item) VALUES ('Ibrahim, Ankara, Turkey');"</span><span class="o">);</span>  
        <span class="n">db</span><span class="o">.</span><span class="na">execSQL</span><span class="o">(</span><span class="s">"INSERT INTO NormalList (Item) VALUES ('Emily, Wellington, New Zealand');"</span><span class="o">);</span>  
        <span class="n">db</span><span class="o">.</span><span class="na">execSQL</span><span class="o">(</span><span class="s">"INSERT INTO NormalList (Item) VALUES ('Omar, Oslo, Norway');"</span><span class="o">);</span>  
        <span class="n">db</span><span class="o">.</span><span class="na">execSQL</span><span class="o">(</span><span class="s">"INSERT INTO NormalList (Item) VALUES ('Fatou, Dakar, Senegal');"</span><span class="o">);</span>  
        <span class="n">db</span><span class="o">.</span><span class="na">execSQL</span><span class="o">(</span><span class="s">"INSERT INTO NormalList (Item) VALUES ('Olivia, Vancouver, Canada');"</span><span class="o">);</span>  
        <span class="n">db</span><span class="o">.</span><span class="na">execSQL</span><span class="o">(</span><span class="s">"INSERT INTO NormalList (Item) VALUES ('Ethan, Cape Town, South Africa');"</span><span class="o">);</span>  
        <span class="n">db</span><span class="o">.</span><span class="na">execSQL</span><span class="o">(</span><span class="s">"INSERT INTO NormalList (Item) VALUES ('Santiago, Bogota, Colombia');"</span><span class="o">);</span>  
        <span class="n">db</span><span class="o">.</span><span class="na">execSQL</span><span class="o">(</span><span class="s">"INSERT INTO NormalList (Item) VALUES ('Isabella, Barcelona, Spain');"</span><span class="o">);</span>  
        <span class="n">db</span><span class="o">.</span><span class="na">execSQL</span><span class="o">(</span><span class="s">"INSERT INTO NormalList (Item) VALUES ('Ming, Shanghai, China');"</span><span class="o">);</span>  
        <span class="n">db</span><span class="o">.</span><span class="na">execSQL</span><span class="o">(</span><span class="s">"INSERT INTO NormalList (Item) VALUES ('Chloe, Singapore, Singapore');"</span><span class="o">);</span>  
        <span class="n">db</span><span class="o">.</span><span class="na">execSQL</span><span class="o">(</span><span class="s">"INSERT INTO NormalList (Item) VALUES ('Mohammed, Dubai, UAE');"</span><span class="o">);</span>  
        <span class="n">db</span><span class="o">.</span><span class="na">execSQL</span><span class="o">(</span><span class="s">"INSERT INTO NormalList (Item) VALUES ('Ava, Melbourne, Australia');"</span><span class="o">);</span>  
        <span class="n">db</span><span class="o">.</span><span class="na">execSQL</span><span class="o">(</span><span class="s">"INSERT INTO NormalList (Item) VALUES ('Luca, Milan, Italy');"</span><span class="o">);</span>  
        <span class="n">db</span><span class="o">.</span><span class="na">execSQL</span><span class="o">(</span><span class="s">"INSERT INTO NormalList (Item) VALUES ('Sakura, Kyoto, Japan');"</span><span class="o">);</span>  
        <span class="n">db</span><span class="o">.</span><span class="na">execSQL</span><span class="o">(</span><span class="s">"INSERT INTO NormalList (Item) VALUES ('Edward, New Jersey, USA');"</span><span class="o">);</span>  
    <span class="o">}</span>
</code></pre></div></div>

<p>If you search for <code class="language-plaintext highlighter-rouge">NaughtyList</code> in the files</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241213195523.png" width="100%" alt="figure"></p>

<p>Let’s look into the <code class="language-plaintext highlighter-rouge">DELETE FROM NaughtyList WHERE Item =</code> Statement in more detail. This seems to be
vulnerable to SQL Injection because the code uses string concatenation</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241213195847.png" width="100%" alt="figure"></p>

<p>There is also a <code class="language-plaintext highlighter-rouge">SELECT</code> statement which filters a specific name in the same file</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241213202144.png" width="100%" alt="figure"></p>

<p>This is the answer for who has been left out from the list.</p>

<p>Solution:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Ellie
</code></pre></div></div>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241213202309.png" width="100%" alt="figure"></p>

<p>Talk to Eve Snowshoes again</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241213202449.png" width="100%" alt="figure"></p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241213202612.png" width="100%" alt="figure"></p>

<p>He gives you two hints for the gold solution</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241213202728.png" width="100%" alt="figure"><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241213202741.png" width="100%" alt="figure"></p>

<p>First I started with some investigations using JADX-GUI in <code class="language-plaintext highlighter-rouge">SantaSwipeSecure.aab</code>.</p>

<p>There you can find the <code class="language-plaintext highlighter-rouge">naughtynicelist.db</code></p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241207210747.png" width="100%" alt="figure"></p>

<p>and some interesting inital data</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241207210757.png" width="100%" alt="figure"></p>

<p>You can use Genymotion to get some visual experience how SantaSwipeSecure looks like</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  959  keytool <span class="nt">-genkey</span> <span class="nt">-alias</span> server <span class="nt">-validity</span> 365 <span class="nt">-keyalg</span> RSA <span class="nt">-keystore</span> keystore 
  962  java <span class="nt">-jar</span> bundletool-all-1.17.2.jar build-apks <span class="nt">--bundle</span><span class="o">=</span>&lt;path_to_SantaSwipeSecure_aab&gt;/SantaSwipeSecure.aab <span class="nt">--output</span><span class="o">=</span>&lt;path_to_SantaSwipeSecure_aab&gt;/output.apks <span class="nt">--mode</span><span class="o">=</span>universal <span class="nt">--ks</span><span class="o">=</span>&lt;path_to_SantaSwipeSecure_aab&gt;/keystore <span class="nt">--ks-key-alias</span><span class="o">=</span>server <span class="nt">--ks-pass</span><span class="o">=</span>pass:keystore
  964  <span class="nb">mv </span>output.apks generate_apk/output.apks
  965  <span class="nb">cd </span>generate_apk
  967  <span class="nb">cp </span>output.apks output.zip
  968  unzip output.zip <span class="nt">-d</span> &lt;path_to_SantaSwipeSecure_aab&gt;/generate_apk/

</code></pre></div></div>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241213000031.png" width="100%" alt="figure"></p>

<p>Back in <code class="language-plaintext highlighter-rouge">SantaSwipe.apk</code> in the file <code class="language-plaintext highlighter-rouge">DatabaseHelper</code> you can find this function</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241214012050.png" width="100%" alt="figure"></p>

<p>and</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241214005812.png" width="100%" alt="figure"></p>

<p>If you convert this to java code</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">cat</span> <span class="nc">Charsets</span><span class="o">.</span><span class="na">java</span>
<span class="kn">import</span> <span class="nn">java.nio.charset.Charset</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">final</span> <span class="kd">class</span> <span class="nc">Charsets</span> <span class="o">{</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="nc">Charsets</span> <span class="no">INSTANCE</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Charsets</span><span class="o">();</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="nc">Charset</span> <span class="no">ISO_8859_1</span><span class="o">;</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="nc">Charset</span> <span class="no">US_ASCII</span><span class="o">;</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="nc">Charset</span> <span class="no">UTF_16</span><span class="o">;</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="nc">Charset</span> <span class="no">UTF_16BE</span><span class="o">;</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="nc">Charset</span> <span class="no">UTF_16LE</span><span class="o">;</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="nc">Charset</span> <span class="no">UTF_8</span><span class="o">;</span>
<span class="kd">private</span> <span class="kd">static</span> <span class="kd">volatile</span> <span class="nc">Charset</span> <span class="n">utf_32</span><span class="o">;</span>
<span class="kd">private</span> <span class="kd">static</span> <span class="kd">volatile</span> <span class="nc">Charset</span> <span class="n">utf_32be</span><span class="o">;</span>
<span class="kd">private</span> <span class="kd">static</span> <span class="kd">volatile</span> <span class="nc">Charset</span> <span class="n">utf_32le</span><span class="o">;</span>

    <span class="kd">private</span> <span class="nf">Charsets</span><span class="o">()</span> <span class="o">{</span>
    <span class="o">}</span>

    <span class="kd">static</span> <span class="o">{</span>
        <span class="nc">Charset</span> <span class="n">forName</span> <span class="o">=</span> <span class="nc">Charset</span><span class="o">.</span><span class="na">forName</span><span class="o">(</span><span class="s">"UTF-8"</span><span class="o">);</span>
        <span class="no">UTF_8</span> <span class="o">=</span> <span class="n">forName</span><span class="o">;</span>
        <span class="nc">Charset</span> <span class="n">forName2</span> <span class="o">=</span> <span class="nc">Charset</span><span class="o">.</span><span class="na">forName</span><span class="o">(</span><span class="s">"UTF-16"</span><span class="o">);</span>
        <span class="no">UTF_16</span> <span class="o">=</span> <span class="n">forName2</span><span class="o">;</span>
        <span class="nc">Charset</span> <span class="n">forName3</span> <span class="o">=</span> <span class="nc">Charset</span><span class="o">.</span><span class="na">forName</span><span class="o">(</span><span class="s">"UTF-16BE"</span><span class="o">);</span>
        <span class="no">UTF_16BE</span> <span class="o">=</span> <span class="n">forName3</span><span class="o">;</span>
        <span class="nc">Charset</span> <span class="n">forName4</span> <span class="o">=</span> <span class="nc">Charset</span><span class="o">.</span><span class="na">forName</span><span class="o">(</span><span class="s">"UTF-16LE"</span><span class="o">);</span>
        <span class="no">UTF_16LE</span> <span class="o">=</span> <span class="n">forName4</span><span class="o">;</span>
        <span class="nc">Charset</span> <span class="n">forName5</span> <span class="o">=</span> <span class="nc">Charset</span><span class="o">.</span><span class="na">forName</span><span class="o">(</span><span class="s">"US-ASCII"</span><span class="o">);</span>
        <span class="no">US_ASCII</span> <span class="o">=</span> <span class="n">forName5</span><span class="o">;</span>
        <span class="nc">Charset</span> <span class="n">forName6</span> <span class="o">=</span> <span class="nc">Charset</span><span class="o">.</span><span class="na">forName</span><span class="o">(</span><span class="s">"ISO-8859-1"</span><span class="o">);</span>
        <span class="no">ISO_8859_1</span> <span class="o">=</span> <span class="n">forName6</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kd">final</span> <span class="nc">Charset</span> <span class="nf">UTF32</span><span class="o">()</span> <span class="o">{</span>
        <span class="nc">Charset</span> <span class="n">charset</span> <span class="o">=</span> <span class="n">utf_32</span><span class="o">;</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">charset</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">return</span> <span class="n">charset</span><span class="o">;</span>
        <span class="o">}</span>
        <span class="nc">Charset</span> <span class="n">forName</span> <span class="o">=</span> <span class="nc">Charset</span><span class="o">.</span><span class="na">forName</span><span class="o">(</span><span class="s">"UTF-32"</span><span class="o">);</span>
        <span class="n">utf_32</span> <span class="o">=</span> <span class="n">forName</span><span class="o">;</span>
        <span class="k">return</span> <span class="n">forName</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kd">final</span> <span class="nc">Charset</span> <span class="nf">UTF32_LE</span><span class="o">()</span> <span class="o">{</span>
        <span class="nc">Charset</span> <span class="n">charset</span> <span class="o">=</span> <span class="n">utf_32le</span><span class="o">;</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">charset</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">return</span> <span class="n">charset</span><span class="o">;</span>
        <span class="o">}</span>
        <span class="nc">Charset</span> <span class="n">forName</span> <span class="o">=</span> <span class="nc">Charset</span><span class="o">.</span><span class="na">forName</span><span class="o">(</span><span class="s">"UTF-32LE"</span><span class="o">);</span>
        <span class="n">utf_32le</span> <span class="o">=</span> <span class="n">forName</span><span class="o">;</span>
        <span class="k">return</span> <span class="n">forName</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kd">final</span> <span class="nc">Charset</span> <span class="nf">UTF32_BE</span><span class="o">()</span> <span class="o">{</span>
        <span class="nc">Charset</span> <span class="n">charset</span> <span class="o">=</span> <span class="n">utf_32be</span><span class="o">;</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">charset</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">return</span> <span class="n">charset</span><span class="o">;</span>
        <span class="o">}</span>
        <span class="nc">Charset</span> <span class="n">forName</span> <span class="o">=</span> <span class="nc">Charset</span><span class="o">.</span><span class="na">forName</span><span class="o">(</span><span class="s">"UTF-32BE"</span><span class="o">);</span>
        <span class="n">utf_32be</span> <span class="o">=</span> <span class="n">forName</span><span class="o">;</span>
        <span class="k">return</span> <span class="n">forName</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">cat</span> <span class="nc">Decrypt</span><span class="o">.</span><span class="na">java</span>
<span class="kn">import</span> <span class="nn">java.util.ArrayList</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.Iterator</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.List</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.crypto.Cipher</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.crypto.spec.GCMParameterSpec</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.crypto.spec.SecretKeySpec</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.Base64</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Decrypt</span> <span class="o">{</span>

    <span class="kd">private</span> <span class="kd">final</span> <span class="kt">byte</span><span class="o">[]</span> <span class="n">iv</span><span class="o">;</span>	
    <span class="kd">private</span> <span class="kd">final</span> <span class="nc">SecretKeySpec</span> <span class="n">secretKeySpec</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="kt">byte</span><span class="o">[]</span> <span class="n">encryptionKey</span><span class="o">;</span>
  
    <span class="kd">public</span> <span class="nf">Decrypt</span><span class="o">()</span> <span class="o">{</span>
        <span class="nc">String</span> <span class="n">obj</span> <span class="o">=</span> <span class="s">"rmDJ1wJ7ZtKy3lkLs6X9bZ2Jvpt6jL6YWiDsXtgjkXw="</span><span class="o">;</span>
        <span class="kt">byte</span><span class="o">[]</span> <span class="n">decode</span> <span class="o">=</span> <span class="nc">Base64</span><span class="o">.</span><span class="na">getDecoder</span><span class="o">().</span><span class="na">decode</span><span class="o">(</span><span class="n">obj</span><span class="o">);</span>
        <span class="k">this</span><span class="o">.</span><span class="na">encryptionKey</span> <span class="o">=</span> <span class="n">decode</span><span class="o">;</span> 
        <span class="k">this</span><span class="o">.</span><span class="na">secretKeySpec</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">SecretKeySpec</span><span class="o">(</span><span class="n">decode</span><span class="o">,</span> <span class="s">"AES"</span><span class="o">);</span>
        <span class="n">obj</span> <span class="o">=</span> <span class="s">"Q2hlY2tNYXRlcml4"</span><span class="o">;</span>
        <span class="n">decode</span> <span class="o">=</span> <span class="nc">Base64</span><span class="o">.</span><span class="na">getDecoder</span><span class="o">().</span><span class="na">decode</span><span class="o">(</span><span class="n">obj</span><span class="o">);</span>
        <span class="k">this</span><span class="o">.</span><span class="na">iv</span> <span class="o">=</span> <span class="n">decode</span><span class="o">;</span>
    <span class="o">}</span>
     
    <span class="kd">private</span> <span class="kd">final</span> <span class="nc">String</span> <span class="nf">decryptData</span><span class="o">(</span><span class="nc">String</span> <span class="n">encryptedData</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">try</span> <span class="o">{</span>
            <span class="nc">Cipher</span> <span class="n">cipher</span> <span class="o">=</span> <span class="nc">Cipher</span><span class="o">.</span><span class="na">getInstance</span><span class="o">(</span><span class="s">"AES/GCM/NoPadding"</span><span class="o">);</span>
            <span class="n">cipher</span><span class="o">.</span><span class="na">init</span><span class="o">(</span><span class="mi">2</span><span class="o">,</span> <span class="k">this</span><span class="o">.</span><span class="na">secretKeySpec</span><span class="o">,</span> <span class="k">new</span> <span class="nc">GCMParameterSpec</span><span class="o">(</span><span class="mi">128</span><span class="o">,</span> <span class="k">this</span><span class="o">.</span><span class="na">iv</span><span class="o">));</span>
            <span class="kt">byte</span><span class="o">[]</span> <span class="n">doFinal</span> <span class="o">=</span> <span class="n">cipher</span><span class="o">.</span><span class="na">doFinal</span><span class="o">(</span><span class="nc">Base64</span><span class="o">.</span><span class="na">getDecoder</span><span class="o">().</span><span class="na">decode</span><span class="o">(</span><span class="n">encryptedData</span><span class="o">));</span>
            <span class="k">if</span> <span class="o">(</span><span class="n">doFinal</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span> <span class="k">return</span> <span class="s">""</span><span class="o">;</span>
            <span class="k">return</span> <span class="k">new</span> <span class="nf">String</span><span class="o">(</span><span class="n">doFinal</span><span class="o">,</span> <span class="nc">Charsets</span><span class="o">.</span><span class="na">UTF_8</span><span class="o">);</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
            <span class="k">return</span> <span class="kc">null</span><span class="o">;</span>
        <span class="o">}</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">Decrypt</span> <span class="n">d</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Decrypt</span><span class="o">();</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">d</span><span class="o">.</span><span class="na">decryptData</span><span class="o">(</span><span class="s">"Base64todecrypt"</span><span class="o">));</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<p>Take the following as the input for the <code class="language-plaintext highlighter-rouge">decryptData</code> function</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241214011930.png" width="100%" alt="figure"></p>

<p>and run this code</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>java Decrypt
</code></pre></div></div>

<p>the output is</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241214011946.png" width="100%" alt="figure"></p>

<p>Another interesting value to decrypt is</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241214012017.png" width="100%" alt="figure"></p>

<p>which yields to</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241214011720.png" width="100%" alt="figure"></p>

<p>Oh! This is something deleting from the list. Let’s inspect that:</p>

<p>The output <code class="language-plaintext highlighter-rouge">KGfb0vd4u/4EWMN0bp035hRjjpMiL4NQurjgHIQHNaRaDnIYbKQ9JusGaa1aAkGEVV8=</code> decrypted is</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241214011849.png" width="100%" alt="figure"></p>

<p>So the solution then for gold would be</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Joshua
</code></pre></div></div>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241214011632.png" width="100%" alt="figure"></p>

<h2 id="snowball-showdown">
<a class="anchor" href="#snowball-showdown" aria-hidden="true"><span class="octicon octicon-link"></span></a>Snowball Showdown</h2>

<p>The next thing I tackled was the Snowball Showdown. This is where Dusty Giftwrap is located</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241208025225.png" width="100%" alt="figure">
<img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241208025436.png" width="100%" alt="figure">
<img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241208025448.png" width="100%" alt="figure"></p>

<p>So the task is</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241216233352.png" width="100%" alt="figure"></p>

<p>Run Snowball Showdown in Chrome or Safari - Firefox is really laggy</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241208030044.png" width="100%" alt="figure">
<img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241208025635.png" width="100%" alt="figure"></p>

<p>In the background web sockets are used</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241216235916.png" width="100%" alt="figure">
<img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241217002406.png" width="100%" alt="figure"></p>

<p>If you start the game in the url you can find a key value pair which controls if the game is single player</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241222015922.png" width="100%" alt="figure">
<img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241222015947.png" width="100%" alt="figure"></p>

<p>Set it to true to play alone</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241222020143.png" width="100%" alt="figure"></p>

<p>From the files copy <code class="language-plaintext highlighter-rouge">phaser-snowball-game.js</code>  to a local file</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241222021507.png" width="100%" alt="figure"></p>

<p>Set a breakpoint and disbalance team strength</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241222025732.png" width="100%" alt="figure"></p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241222025417.png" width="100%" alt="figure"></p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">data</span><span class="p">.</span><span class="nx">alabasterElves</span><span class="p">.</span><span class="nf">push</span><span class="p">(</span><span class="nx">data</span><span class="p">.</span><span class="nx">alabasterElves</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</code></pre></div></div>

<p>I tried to add elves to increase team of Alabaster</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241222025531.png" width="100%" alt="figure"></p>

<p>On the other side I tried to decrease the size of the team from Wombley</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">data</span><span class="p">.</span><span class="nx">wombleyElves</span> <span class="o">=</span> <span class="nx">data</span><span class="p">.</span><span class="nx">wombleyElves</span><span class="p">.</span><span class="nf">pop</span><span class="p">()</span>
</code></pre></div></div>

<p>Then I played and try to get more points, finally resulting in bronze rating for the challenge</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241222025259.png" width="100%" alt="figure">
<img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241222025349.png" width="100%" alt="figure"></p>

<h2 id="drone-path">
<a class="anchor" href="#drone-path" aria-hidden="true"><span class="octicon octicon-link"></span></a>Drone Path</h2>

<p>For the next challenge go through the tunnels in the DMZ to Chimney Scissorsticks</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241214013223.png" width="100%" alt="figure">
<img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241211224606.png" width="100%" alt="figure">
<img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241211224845.png" width="100%" alt="figure"></p>

<p>The task is the following</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241214012414.png" width="100%" alt="figure"></p>

<p>So let’s start!</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241214013240.png" width="100%" alt="figure">
<img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241214013405.png" width="100%" alt="figure"><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241214013428.png" width="100%" alt="figure">
<img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241214013445.png" width="100%" alt="figure"></p>

<p>I downloaded the file and viewed it with a KML viewer in the internet</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241214014313.png" width="100%" alt="figure"></p>

<p>So this looks like <code class="language-plaintext highlighter-rouge">DROP1</code> ? But this you cannot use anywhere. From the characters left this seems to be incomlete.
So I analyzed the file <code class="language-plaintext highlighter-rouge">fritjolf-Path.kml</code> deeper using <code class="language-plaintext highlighter-rouge">cat</code>.</p>

<p>Mm, there seems to be a link to google earth. So open the KML with Google Earth</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241214014603.png" width="100%" alt="figure"></p>

<p>If you import the KML file here you get this</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241214014528.png" width="100%" alt="figure"></p>

<p>And this is the needed password for login. The username you can get from the filename. The credentials:</p>

<p><code class="language-plaintext highlighter-rouge">fritjolf/GUMDROP1</code></p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241214015601.png" width="100%" alt="figure">
<img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241214015529.png" width="100%" alt="figure">
<img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241214015714.png" width="100%" alt="figure"></p>

<p>There is the next challenge</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241214015729.png" width="100%" alt="figure"></p>

<p>Download CSV. Let’s inspect what’s inside.</p>

<p>For that I used libreoffice: <code class="language-plaintext highlighter-rouge">libreoffice Preparations-drone-name.csv</code> and imported the csv there.</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241214020517.png" width="100%" alt="figure"></p>

<p>The longitude and latitude coordinates there yields to a route <a href="https://maps.app.goo.gl/uGa2YFD12wx4VDLF6" target="_blank" rel="noopener noreferrer">https://maps.app.goo.gl/uGa2YFD12wx4VDLF6</a></p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241214022547.png" width="100%" alt="figure"></p>

<p>If you inspect those coordinate with google maps you can find some interesting thing. If you from map to satellite and look at the environment you can see:</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241214230105.png" width="100%" alt="figure"></p>

<p>This is definitely an <code class="language-plaintext highlighter-rouge">E</code> :)</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241214230130.png" width="100%" alt="figure"></p>

<p>Here is an <code class="language-plaintext highlighter-rouge">L</code>!</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241214230033.png" width="100%" alt="figure"></p>

<p><code class="language-plaintext highlighter-rouge">F</code></p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241214230205.png" width="100%" alt="figure"></p>

<p><code class="language-plaintext highlighter-rouge">-</code> or <code class="language-plaintext highlighter-rouge">I</code></p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241214230251.png" width="100%" alt="figure"></p>

<p><code class="language-plaintext highlighter-rouge">H</code></p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241214230333.png" width="100%" alt="figure"></p>

<p><code class="language-plaintext highlighter-rouge">A</code></p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241214230445.png" width="100%" alt="figure"></p>

<p><code class="language-plaintext highlighter-rouge">W</code></p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241214230517.png" width="100%" alt="figure"></p>

<p><code class="language-plaintext highlighter-rouge">K</code></p>

<p>So we have <code class="language-plaintext highlighter-rouge">ELF-HAWK</code> or <code class="language-plaintext highlighter-rouge">ELFIHAWK</code></p>

<p>If you search for this as a Drone you get</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241214231615.png" width="100%" alt="figure"></p>

<p>So you have a new CSV file.</p>

<p>I would say the keywords LONG and LATTER are a hint for Longitude and Latitude inside the file</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241215005858.png" width="100%" alt="figure"></p>

<p>For longitude values you can use</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">cut</span> <span class="nt">-f</span> 5 ../ELF-HAWK-dump.csv <span class="nt">-d</span> <span class="s2">","</span> | <span class="nb">paste</span> <span class="nt">-s</span> <span class="nt">-d</span>,
</code></pre></div></div>

<p>For the latitude values</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">cut</span> <span class="nt">-f</span> 6 ../ELF-HAWK-dump.csv <span class="nt">-d</span> <span class="s2">","</span> | <span class="nb">paste</span> <span class="nt">-s</span> <span class="nt">-d</span>,
</code></pre></div></div>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241215005030.png" width="100%" alt="figure"></p>

<p>Copy those values into a <a href="https://geopandas.org/en/stable/" target="_blank" rel="noopener noreferrer">geopandas</a> python script.
geopandas needs a <a href="https://en.wikipedia.org/wiki/Spatial_reference_system#External_links" target="_blank" rel="noopener noreferrer">CRS</a>.
The most commonly used in the US seems to be EPSG: 4326:</p>

<blockquote>
  <p>WGS84 (EPSG: 4326) - Commonly used by organizations that provide GIS data for the entire globe or many countries. CRS used by Google Earth</p>
</blockquote>

<p><a href="https://www.nceas.ucsb.edu/sites/default/files/2020-04/OverviewCoordinateReferenceSystems.pdf" target="_blank" rel="noopener noreferrer">Overview of Coordinate Reference Systems (CRS) in R</a></p>

<p>So you can set EPSG:4326 / WGS84 (https://en.wikipedia.org/wiki/World_Geodetic_System#WGS84) as CRS</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">cat</span> <span class="n">dronepath</span><span class="p">.</span><span class="n">py</span> 
<span class="kn">import</span> <span class="n">pandas</span> <span class="k">as</span> <span class="n">pd</span>
<span class="kn">from</span> <span class="n">shapely.geometry</span> <span class="kn">import</span> <span class="n">LineString</span>
<span class="kn">import</span> <span class="n">geopandas</span> <span class="k">as</span> <span class="n">gpd</span>
<span class="kn">import</span> <span class="n">folium</span>

<span class="c1"># prepare data
</span><span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="sh">'</span><span class="s">Latitude</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="o">&lt;</span><span class="n">Latitude</span> <span class="n">values</span> <span class="n">comma</span> <span class="n">separated</span><span class="p">],</span>
         <span class="sh">'</span><span class="s">Longitude</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="o">&lt;</span><span class="n">Longitude</span> <span class="n">Values</span> <span class="n">comma</span> <span class="n">separated</span><span class="o">&gt;</span><span class="p">]}</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="nc">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

<span class="c1"># create lines
</span><span class="n">geometry</span> <span class="o">=</span> <span class="p">[</span><span class="nc">LineString</span><span class="p">([(</span><span class="n">lon</span><span class="p">,</span> <span class="n">lat</span><span class="p">)</span> <span class="k">for</span> <span class="n">lat</span><span class="p">,</span> <span class="n">lon</span> <span class="ow">in</span> <span class="nf">zip</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="sh">'</span><span class="s">Latitude</span><span class="sh">'</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="sh">'</span><span class="s">Longitude</span><span class="sh">'</span><span class="p">])])]</span>
<span class="n">gdf</span> <span class="o">=</span> <span class="n">gpd</span><span class="p">.</span><span class="nc">GeoDataFrame</span><span class="p">(</span><span class="n">geometry</span><span class="o">=</span><span class="n">geometry</span><span class="p">)</span>

<span class="c1"># create map
</span><span class="n">m</span> <span class="o">=</span> <span class="n">folium</span><span class="p">.</span><span class="nc">Map</span><span class="p">(</span><span class="n">location</span><span class="o">=</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="sh">'</span><span class="s">Latitude</span><span class="sh">'</span><span class="p">].</span><span class="nf">mean</span><span class="p">(),</span> <span class="n">df</span><span class="p">[</span><span class="sh">'</span><span class="s">Longitude</span><span class="sh">'</span><span class="p">].</span><span class="nf">mean</span><span class="p">()],</span> <span class="n">zoom_start</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">gdf</span><span class="p">.</span><span class="n">crs</span> <span class="o">=</span> <span class="sh">"</span><span class="s">epsg:4326</span><span class="sh">"</span>
<span class="n">folium</span><span class="p">.</span><span class="nc">GeoJson</span><span class="p">(</span><span class="n">gdf</span><span class="p">).</span><span class="nf">add_to</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
<span class="n">m</span><span class="p">.</span><span class="nf">save</span><span class="p">(</span><span class="sh">'</span><span class="s">flugroute.html</span><span class="sh">'</span><span class="p">)</span>
</code></pre></div></div>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241215005446.png" width="100%" alt="figure"></p>

<p>So the final solution (for silver) is</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>DroneDataAnalystExpertMedal
</code></pre></div></div>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241215005629.png" width="100%" alt="figure"></p>

<p>Back to Chimney Scissorsticks</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241215010620.png" width="100%" alt="figure">
<img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241215010713.png" width="100%" alt="figure"></p>

<p>On the Wombley side there is Garland Candlesticks</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241215011352.png" width="100%" alt="figure">
<img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241215011703.png" width="100%" alt="figure"></p>

<p>and Wombley Cube</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241215012033.png" width="100%" alt="figure">
<img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241215012042.png" width="100%" alt="figure"></p>

<h2 id="powershell">
<a class="anchor" href="#powershell" aria-hidden="true"><span class="octicon octicon-link"></span></a>PowerShell</h2>

<p>Piney Sappington introduces to a new challenge about PowerShell</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241215012306.png" width="100%" alt="figure">
<img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241215012503.png" width="100%" alt="figure"></p>

<p>The solutions are</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241215012618.png" width="100%" alt="figure"></p>

<div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">y</span><span class="w">
</span></code></pre></div></div>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241215012643.png" width="100%" alt="figure"></p>

<div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">dir</span><span class="w">
</span><span class="nx">type</span><span class="w"> </span><span class="nx">welcome.txt</span><span class="w">
</span></code></pre></div></div>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241215012725.png" width="100%" alt="figure">
<img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241215012744.png" width="100%" alt="figure">
<img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241215013323.png" width="100%" alt="figure"></p>

<div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kr">type</span><span class="w"> </span><span class="n">welcome.txt</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">Measure-Object</span><span class="w"> </span><span class="nt">-word</span><span class="w">
</span></code></pre></div></div>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241215013455.png" width="100%" alt="figure"></p>

<div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">netstat</span><span class="w"> </span><span class="nt">-an</span><span class="w">
</span></code></pre></div></div>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241215013634.png" width="100%" alt="figure"></p>

<div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">Invoke-WebRequest</span><span class="w"> </span><span class="nx">http://127.0.0.1:1225</span><span class="w">
</span></code></pre></div></div>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241215013800.png" width="100%" alt="figure"></p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241215223435.png" width="100%" alt="figure"></p>

<div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kr">function</span><span class="w"> </span><span class="nf">BasicAuth</span><span class="p">(</span><span class="nv">$user</span><span class="p">,</span><span class="w"> </span><span class="nv">$pass</span><span class="p">,</span><span class="w"> </span><span class="nv">$url</span><span class="p">,</span><span class="w"> </span><span class="nv">$cookie_name</span><span class="p">,</span><span class="w"> </span><span class="nv">$cookie_value</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
 </span><span class="nv">$pair</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"</span><span class="si">$(</span><span class="nv">$user</span><span class="si">)</span><span class="s2">:</span><span class="si">$(</span><span class="nv">$pass</span><span class="si">)</span><span class="s2">"</span><span class="w">
 </span><span class="nv">$encodedCreds</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">System.Convert</span><span class="p">]::</span><span class="n">ToBase64String</span><span class="p">([</span><span class="n">System.Text.Encoding</span><span class="p">]::</span><span class="n">ASCII.GetBytes</span><span class="p">(</span><span class="nv">$pair</span><span class="p">))</span><span class="w">
  </span><span class="nv">$headers</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">@{</span><span class="w">
  </span><span class="nx">Authorization</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Basic </span><span class="nv">$encodedCreds</span><span class="s2">"</span><span class="w">
 </span><span class="p">}</span><span class="w">
 
 </span><span class="kr">if</span><span class="w"> </span><span class="p">(</span><span class="o">-not</span><span class="w"> </span><span class="nv">$cookie_name</span><span class="p">)</span><span class="w">
 </span><span class="p">{</span><span class="w">
	</span><span class="nv">$response</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Invoke-WebRequest</span><span class="w"> </span><span class="nv">$url</span><span class="w"> </span><span class="nt">-Headers</span><span class="w"> </span><span class="nv">$headers</span><span class="w">
 </span><span class="p">}</span><span class="w">
 </span><span class="kr">else</span><span class="w"> 
 </span><span class="p">{</span><span class="w">
	 </span><span class="nv">$session</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">New-Object</span><span class="w"> </span><span class="nx">Microsoft.PowerShell.Commands.WebRequestSession</span><span class="w">
	 </span><span class="nv">$cookie</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">New-Object</span><span class="w"> </span><span class="nx">System.Net.Cookie</span><span class="w">
	 </span><span class="nv">$cookie</span><span class="o">.</span><span class="nf">Name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">$cookie_name</span><span class="w">
	 </span><span class="nv">$cookie</span><span class="o">.</span><span class="nf">Value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">$cookie_value</span><span class="w">
	 </span><span class="nv">$cookie</span><span class="o">.</span><span class="nf">Domain</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"127.0.0.1"</span><span class="w">
	 </span><span class="nv">$session</span><span class="o">.</span><span class="nf">Cookies</span><span class="o">.</span><span class="nf">Add</span><span class="p">(</span><span class="nv">$cookie</span><span class="p">);</span><span class="w">
	 </span><span class="nv">$response</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Invoke-WebRequest</span><span class="w"> </span><span class="nv">$url</span><span class="w"> </span><span class="nt">-Headers</span><span class="w"> </span><span class="nv">$headers</span><span class="w"> </span><span class="nt">-WebSession</span><span class="w"> </span><span class="nv">$session</span><span class="w">
 </span><span class="p">}</span><span class="w">
 
 </span><span class="nv">$response</span><span class="w">
</span><span class="p">}</span><span class="w">

</span><span class="kr">function</span><span class="w"> </span><span class="nf">BasicAuth</span><span class="p">(</span><span class="nv">$user</span><span class="p">,</span><span class="w"> </span><span class="nv">$pass</span><span class="p">,</span><span class="w"> </span><span class="nv">$url</span><span class="p">,</span><span class="w"> </span><span class="nv">$cookieHashTable</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
 </span><span class="nv">$pair</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"</span><span class="si">$(</span><span class="nv">$user</span><span class="si">)</span><span class="s2">:</span><span class="si">$(</span><span class="nv">$pass</span><span class="si">)</span><span class="s2">"</span><span class="w">
 </span><span class="nv">$encodedCreds</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">System.Convert</span><span class="p">]::</span><span class="n">ToBase64String</span><span class="p">([</span><span class="n">System.Text.Encoding</span><span class="p">]::</span><span class="n">ASCII.GetBytes</span><span class="p">(</span><span class="nv">$pair</span><span class="p">))</span><span class="w">
  </span><span class="nv">$headers</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">@{</span><span class="w">
  </span><span class="nx">Authorization</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Basic </span><span class="nv">$encodedCreds</span><span class="s2">"</span><span class="w">
 </span><span class="p">}</span><span class="w">
 
 </span><span class="kr">if</span><span class="w"> </span><span class="p">(</span><span class="o">-not</span><span class="w"> </span><span class="nv">$cookieHashTable</span><span class="p">)</span><span class="w">
 </span><span class="p">{</span><span class="w">
	</span><span class="nv">$response</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Invoke-WebRequest</span><span class="w"> </span><span class="nv">$url</span><span class="w"> </span><span class="nt">-Headers</span><span class="w"> </span><span class="nv">$headers</span><span class="w">
 </span><span class="p">}</span><span class="w">
 </span><span class="kr">else</span><span class="w"> 
 </span><span class="p">{</span><span class="w">
	 </span><span class="nv">$session</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">New-Object</span><span class="w"> </span><span class="nx">Microsoft.PowerShell.Commands.WebRequestSession</span><span class="w">
	 </span><span class="kr">foreach</span><span class="w"> </span><span class="p">(</span><span class="nv">$element</span><span class="w"> </span><span class="kr">in</span><span class="w"> </span><span class="nv">$cookieHashTable</span><span class="o">.</span><span class="nf">getEnumerator</span><span class="p">())</span><span class="w"> </span><span class="p">{</span><span class="w">
		 </span><span class="nv">$cookie</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">New-Object</span><span class="w"> </span><span class="nx">System.Net.Cookie</span><span class="w">
		 </span><span class="nv">$cookie</span><span class="o">.</span><span class="nf">Name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">$element</span><span class="o">.</span><span class="nf">Key</span><span class="w">
		 </span><span class="nv">$cookie</span><span class="o">.</span><span class="nf">Value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">$element</span><span class="o">.</span><span class="nf">Value</span><span class="w">
		 </span><span class="nv">$cookie</span><span class="o">.</span><span class="nf">Domain</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"127.0.0.1"</span><span class="w">
		 </span><span class="nv">$session</span><span class="o">.</span><span class="nf">Cookies</span><span class="o">.</span><span class="nf">Add</span><span class="p">(</span><span class="nv">$cookie</span><span class="p">);</span><span class="w">
	 </span><span class="p">}</span><span class="w">
	
	 </span><span class="nv">$response</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Invoke-WebRequest</span><span class="w"> </span><span class="nv">$url</span><span class="w"> </span><span class="nt">-Headers</span><span class="w"> </span><span class="nv">$headers</span><span class="w"> </span><span class="nt">-WebSession</span><span class="w"> </span><span class="nv">$session</span><span class="w">
 </span><span class="p">}</span><span class="w">
 
 </span><span class="nv">$response</span><span class="w">
</span><span class="p">}</span><span class="w">
</span><span class="c"># Use it like BasicAuth admin admin http://127.0.0.1:1225 @{token ="xyz"; mfa_token ="abc"}</span><span class="w">
</span></code></pre></div></div>

<div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$response</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">BasicAuth</span><span class="w"> </span><span class="s2">"admin"</span><span class="w"> </span><span class="s2">"admin"</span><span class="w"> </span><span class="s2">"http://127.0.0.1:1225"</span><span class="w">
</span></code></pre></div></div>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241215223500.png" width="100%" alt="figure"></p>

<div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$response</span><span class="o">.</span><span class="nf">Links</span><span class="w">
</span></code></pre></div></div>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241215223947.png" width="100%" alt="figure"></p>

<div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$links</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">$response</span><span class="o">.</span><span class="nf">Links</span><span class="w">

</span><span class="kr">foreach</span><span class="w"> </span><span class="p">(</span><span class="nv">$link</span><span class="w"> </span><span class="kr">in</span><span class="w"> </span><span class="nv">$links</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">                                             
</span><span class="nv">$href</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">$link</span><span class="o">.</span><span class="nf">href</span><span class="w">
</span><span class="nv">$r</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Invoke-WebRequest</span><span class="w"> </span><span class="nv">$href</span><span class="w">
</span><span class="nv">$x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="nv">$r</span><span class="o">.</span><span class="nf">Content</span><span class="w"> </span><span class="o">-split</span><span class="w"> </span><span class="s1">'\s+'</span><span class="p">)</span><span class="o">.</span><span class="nf">Count</span><span class="w">
</span><span class="kr">if</span><span class="w"> </span><span class="p">(</span><span class="nv">$x</span><span class="w"> </span><span class="o">-eq</span><span class="w"> </span><span class="mi">138</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">Write-Host</span><span class="w"> </span><span class="nv">$href</span><span class="w"> </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241215233208.png" width="100%" alt="figure"></p>

<p>So there is one interesting endpoint <code class="language-plaintext highlighter-rouge">http://localhost:1225/endpoints/13</code>. Let’s look into it</p>

<div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$r</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Invoke-WebRequest</span><span class="w"> </span><span class="s2">"http://localhost:1225/endpoints/13"</span><span class="w">
</span><span class="nv">$r</span><span class="o">.</span><span class="nf">Content</span><span class="w">
</span></code></pre></div></div>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241215233453.png" width="100%" alt="figure">
<img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241215233503.png" width="100%" alt="figure"></p>

<p>There is a hint for a csv file what you can analyze</p>

<div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$r</span><span class="o">=</span><span class="n">Invoke-WebRequest</span><span class="w"> </span><span class="nx">http://127.0.0.1:1225/token_overview.csv</span><span class="w">
</span><span class="nv">$r</span><span class="o">.</span><span class="nf">Content</span><span class="w">
</span></code></pre></div></div>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241215234011.png" width="100%" alt="figure"></p>

<p>This seems to need more so let’s try to authenticate us with the Basic Auth credentials already used</p>

<div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$r</span><span class="w"> </span><span class="o">=</span><span class="w">  </span><span class="n">BasicAuth</span><span class="w"> </span><span class="s2">"admin"</span><span class="w"> </span><span class="s2">"admin"</span><span class="w"> </span><span class="s2">"http://127.0.0.1:1225/token_overview.csv"</span><span class="w">
</span><span class="nv">$r</span><span class="o">.</span><span class="nf">Content</span><span class="w">
</span></code></pre></div></div>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241215234148.png" width="100%" alt="figure">
<img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241215234158.png" width="100%" alt="figure"></p>

<p>Mm, from the response you can infer <code class="language-plaintext highlighter-rouge">http://127.0.0.1:1225/tokens/&lt;sha256sum&gt;</code>. 
Call this page and evaluate the response</p>

<div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$r</span><span class="o">=</span><span class="n">BasicAuth</span><span class="w"> </span><span class="s2">"admin"</span><span class="w"> </span><span class="s2">"admin"</span><span class="w"> </span><span class="s2">"http://127.0.0.1:1225/tokens/4216B4FAF4391EE4D3E0EC53A372B2F24876ED5D124FE08E227F84D687A7E06C"</span><span class="w">
</span><span class="nv">$r</span><span class="o">.</span><span class="nf">Content</span><span class="w"> 
</span></code></pre></div></div>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241215234430.png" width="100%" alt="figure">
<img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241215234450.png" width="100%" alt="figure"></p>

<p>A cookie is missing. Our <code class="language-plaintext highlighter-rouge">BasicAuth</code> function can handle this with the 3rd and 4th parameter</p>

<div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$r</span><span class="o">=</span><span class="n">BasicAuth</span><span class="w"> </span><span class="s2">"admin"</span><span class="w"> </span><span class="s2">"admin"</span><span class="w"> </span><span class="s2">"http://127.0.0.1:1225/tokens/4216B4FAF4391EE4D3E0EC53A372B2F24876ED5D124FE08E227F84D687A7E06C"</span><span class="w"> </span><span class="p">@{</span><span class="nx">token</span><span class="o">=</span><span class="s2">"5f8dd236f862f4507835b0e418907ffc"</span><span class="p">}</span><span class="w"> 
</span><span class="nv">$r</span><span class="o">.</span><span class="nf">Content</span><span class="w">      
</span></code></pre></div></div>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241221020140.png" width="100%" alt="figure"></p>

<p>The response</p>

<div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="err">&lt;</span><span class="n">h1</span><span class="err">&gt;</span><span class="nx">Cookie</span><span class="w"> </span><span class="s1">'mfa_code'</span><span class="p">,</span><span class="w"> </span><span class="nx">use</span><span class="w"> </span><span class="nx">it</span><span class="w"> </span><span class="nx">at</span><span class="w"> </span><span class="err">&lt;</span><span class="nx">a</span><span class="w"> </span><span class="nx">href</span><span class="o">=</span><span class="s1">'1734742884.0846226'</span><span class="err">&gt;</span><span class="n">/mfa_validate/4216B4FAF4391EE4D3E0EC53A372B2F24876ED5D124FE08E227F84D687A7E06C</span><span class="err">&lt;</span><span class="nx">/a</span><span class="err">&gt;&lt;</span><span class="nx">/h1</span><span class="err">&gt;</span><span class="w">
</span></code></pre></div></div>
<p>is an MFA code which you can use at the mentioned endpoint url.</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241221020354.png" width="100%" alt="figure">
<img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241221020803.png" width="100%" alt="figure"></p>

<p>So those two approaches did not work, let’s try to put the code as cookie this way:</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241221021207.png" width="100%" alt="figure">
<img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241221021245.png" width="100%" alt="figure">
<img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241222002405.png" width="100%" alt="figure"></p>

<p>It’s seems that the site needs two cookies, the token cookie and the mfa cookie.</p>

<p>Our written Basic function works like this:</p>

<div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Use it like BasicAuth admin admin http://127.0.0.1:1225 @{token ="xyz"; mfa_token ="abc"}</span><span class="w">
</span></code></pre></div></div>

<p>so you can do</p>

<div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$r</span><span class="o">=</span><span class="n">BasicAuth</span><span class="w"> </span><span class="nx">admin</span><span class="w"> </span><span class="nx">admin</span><span class="w"> </span><span class="nx">http://127.0.0.1:1225/mfa_validate/4216B4FAF4391EE4D3E0EC53A372B2F24876ED5D124FE08E227F84D687A7E06C</span><span class="w"> </span><span class="p">@{</span><span class="nx">token</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"5f8dd236f862f4507835b0e418907ffc"</span><span class="p">;</span><span class="w"> </span><span class="nx">mfa_code</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"1734822972.8962357"</span><span class="p">}</span><span class="w">
</span><span class="nv">$r</span><span class="o">.</span><span class="nf">Content</span><span class="w">
</span></code></pre></div></div>

<p>And from the response you can infer instead of <code class="language-plaintext highlighter-rouge">mfa_code</code> (which was given you as hint before) , it seems that a cookie named <code class="language-plaintext highlighter-rouge">mfa_token</code> is expected.
Let’s try that:</p>

<div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$r</span><span class="o">=</span><span class="n">BasicAuth</span><span class="w"> </span><span class="nx">admin</span><span class="w"> </span><span class="nx">admin</span><span class="w"> </span><span class="nx">http://127.0.0.1:1225/mfa_validate/4216B4FAF4391EE4D3E0EC53A372B2F24876ED5D124FE08E227F84D687A7E06C</span><span class="w"> </span><span class="p">@{</span><span class="nx">token</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"5f8dd236f862f4507835b0e418907ffc"</span><span class="p">;</span><span class="w"> </span><span class="nx">mfa_token</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"1734822972.8962357"</span><span class="p">}</span><span class="w">
</span><span class="nv">$r</span><span class="o">.</span><span class="nf">Content</span><span class="w">
</span></code></pre></div></div>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241222002630.png" width="100%" alt="figure"></p>

<p>Oh, this time took it too long, so probably you need to code something to make it faster. Let’s check that and do the last steps again:</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241222002855.png" width="100%" alt="figure"></p>

<p>Seems only the part for <code class="language-plaintext highlighter-rouge">href</code> is changing if you compare it to the last time which is the value for <code class="language-plaintext highlighter-rouge">mfa_token</code>. To extract you can do</p>

<div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$html</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">$r</span><span class="o">.</span><span class="nf">Content</span><span class="w">
</span><span class="nv">$match</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">$html</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">Select-String</span><span class="w"> </span><span class="nt">-Pattern</span><span class="w"> </span><span class="s2">"&lt;a href='(.*?)'&gt;"</span><span class="w">
</span><span class="nv">$href</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">$match</span><span class="o">.</span><span class="nf">Matches</span><span class="o">.</span><span class="n">Groups</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="nf">Value</span><span class="w">
</span></code></pre></div></div>

<p>This uses</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241222004307.png" width="100%" alt="figure"></p>

<p>The complete snippet then is</p>

<div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$r</span><span class="o">=</span><span class="n">BasicAuth</span><span class="w"> </span><span class="s2">"admin"</span><span class="w"> </span><span class="s2">"admin"</span><span class="w"> </span><span class="s2">"http://127.0.0.1:1225/tokens/4216B4FAF4391EE4D3E0EC53A372B2F24876ED5D124FE08E227F84D687A7E06C"</span><span class="w"> </span><span class="p">@{</span><span class="nx">token</span><span class="o">=</span><span class="s2">"5f8dd236f862f4507835b0e418907ffc"</span><span class="p">}</span><span class="w"> 
</span><span class="nv">$html</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">$r</span><span class="o">.</span><span class="nf">Content</span><span class="w">
</span><span class="nv">$match</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">$html</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">Select-String</span><span class="w"> </span><span class="nt">-Pattern</span><span class="w"> </span><span class="s2">"&lt;a href='(.*?)'&gt;"</span><span class="w">
</span><span class="nv">$href</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">$match</span><span class="o">.</span><span class="nf">Matches</span><span class="o">.</span><span class="n">Groups</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="nf">Value</span><span class="w">
</span><span class="nv">$r</span><span class="o">=</span><span class="n">BasicAuth</span><span class="w"> </span><span class="nx">admin</span><span class="w"> </span><span class="nx">admin</span><span class="w"> </span><span class="nx">http://127.0.0.1:1225/mfa_validate/4216B4FAF4391EE4D3E0EC53A372B2F24876ED5D124FE08E227F84D687A7E06C</span><span class="w"> </span><span class="p">@{</span><span class="nx">token</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"5f8dd236f862f4507835b0e418907ffc"</span><span class="p">;</span><span class="w"> </span><span class="nx">mfa_token</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">$href</span><span class="p">}</span><span class="w">
</span><span class="nv">$r</span><span class="o">.</span><span class="nf">Content</span><span class="w">
</span></code></pre></div></div>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241222005136.png" width="100%" alt="figure"></p>

<p>Response:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$r.Content                                                              
&lt;h1&gt;[+] Success&lt;/h1&gt;&lt;br&gt;&lt;p&gt;Q29ycmVjdCBUb2tlbiBzdXBwbGllZCwgeW91IGFyZSBncmFudGVkIGFjY2VzcyB0byB0aGUgc25vdyBjYW5ub24gdGVybWluYWwuIEhlcmUgaXMgeW91ciBwZXJzb25hbCBwYXNzd29yZCBmb3IgYWNjZXNzOiBTbm93TGVvcGFyZDJSZWFkeUZvckFjdGlvbg==&lt;/p&gt;
</code></pre></div></div>

<p>Looks like base64. To decode it you can implement</p>

<div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$encodedString</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Q29ycmVjdCBUb2tlbiBzdXBwbGllZCwgeW91IGFyZSBncmFudGVkIGFjY2VzcyB0byB0aGUgc25vdyBjYW5ub24gdGVybWluYWwuIEhlcmUgaXMgeW91ciBwZXJzb25hbCBwYXNzd29yZCBmb3IgYWNjZXNzOiBTbm93TGVvcGFyZDJSZWFkeUZvckFjdGlvbg=="</span><span class="w"> 
</span><span class="nv">$decodedBytes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">System.Convert</span><span class="p">]::</span><span class="n">FromBase64String</span><span class="p">(</span><span class="nv">$encodedString</span><span class="p">)</span><span class="w"> 
</span><span class="nv">$decodedString</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">System.Text.Encoding</span><span class="p">]::</span><span class="n">UTF8.GetString</span><span class="p">(</span><span class="nv">$decodedBytes</span><span class="p">)</span><span class="w"> 
</span><span class="n">Write-Host</span><span class="w"> </span><span class="s2">"Decoded String: </span><span class="nv">$decodedString</span><span class="s2">"</span><span class="w">
</span></code></pre></div></div>

<p>which gives you the silver solution</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241222005526.png" width="100%" alt="figure"></p>

<p>The final secret is:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>SnowLeopard2ReadyForAction
</code></pre></div></div>

<p>To get gold, there seems currently to be no clue inside the terminal.
So let’s close the terminal and talk to Piney Sappington again who gives you some hints</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241222010308.png" width="100%" alt="figure">
<img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241222010330.png" width="100%" alt="figure">
<img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241222010443.png" width="100%" alt="figure">
<img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241222010648.png" width="100%" alt="figure">
<img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241222010659.png" width="100%" alt="figure"></p>

<h2 id="north-pole-monitor-station">
<a class="anchor" href="#north-pole-monitor-station" aria-hidden="true"><span class="octicon octicon-link"></span></a>North Pole Monitor Station</h2>

<p>There is also a monitor station again in the middle in the DMZ</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241215234614.png" width="100%" alt="figure">
<img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241215234637.png" width="100%" alt="figure">
<img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241215234732.png" width="100%" alt="figure">
<img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241215234805.png" width="100%" alt="figure">
<img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241215235031.png" width="100%" alt="figure"></p>

<h2 id="the-great-elf-conflict">
<a class="anchor" href="#the-great-elf-conflict" aria-hidden="true"><span class="octicon octicon-link"></span></a>The Great Elf Conflict</h2>

<p>Near Pepper Minstix and Wunorse Openslae in the DMZ you can find the Great Elf Conflict challenge.</p>

<p>Pepper Minstix tells you</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241211223949.png" width="100%" alt="figure">
<img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241216224312.png" width="100%" alt="figure"><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241211224159.png" width="100%" alt="figure"></p>

<p>From Wunorse Openslae you get</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241211224244.png" width="100%" alt="figure">
<img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241211224504.png" width="100%" alt="figure"></p>

<p>This results in multiple tasks - from what there first are</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241216223817.png" width="100%" alt="figure"></p>

<p>To start the challenge create for Microsoft KC7 and account or login using Google or Microsoft.
You are greated with the following text</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241216232421.png" width="100%" alt="figure"><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241216232724.png" width="100%" alt="figure"></p>

<p>There is a small introduction to the web interface what tells you where clusters, query results 
can be found, or queries be made</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241216232752.png" width="100%" alt="figure">
<img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241216232818.png" width="100%" alt="figure">
<img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241216232856.png" width="100%" alt="figure"></p>

<p>The intro text tells you the solution for the first question</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>let's do this
</code></pre></div></div>

<p>Question 2 pops up</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241216232950.png" width="100%" alt="figure"></p>

<p>Let’s perform the steps described</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241216233040.png" width="100%" alt="figure"></p>

<pre><code class="language-SQL">Employees
</code></pre>

<p>which gives you a list of all employees</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241217231516.png" width="100%" alt="figure"></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Employees
| take 10
</code></pre></div></div>

<p>filters you the first 10 entries of this list</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241217231600.png" width="100%" alt="figure"></p>

<p>At available tables you can get an overview of all tables existing</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241217231649.png" width="100%" alt="figure">
<img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241217231702.png" width="100%" alt="figure"></p>

<p>So to end question 2</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241217231751.png" width="100%" alt="figure"></p>

<p>enter the mentioned text</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>when in doubt take 10
</code></pre></div></div>

<p>Question 3 asks to count the employees</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241217231842.png" width="100%" alt="figure">
<img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241217231955.png" width="100%" alt="figure"></p>

<p>The solution:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>90
</code></pre></div></div>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241217232128.png" width="100%" alt="figure"></p>

<p>Now specific entries of the table are of interest</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241217232400.png" width="100%" alt="figure">
<img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241217232443.png" width="100%" alt="figure">
<img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241217232452.png" width="100%" alt="figure"></p>

<p>Enter</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Shinny Upatree
</code></pre></div></div>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241217232517.png" width="100%" alt="figure"></p>

<p>In the next step operators are explained</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241217232659.png" width="100%" alt="figure"></p>

<p>To proceed enter the text described</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>operator
</code></pre></div></div>

<p>In question 6 two tables are connected the first time. Get the email address from
Angel Candysalt from the <code class="language-plaintext highlighter-rouge">Employee</code> table and then put it into the query in the <code class="language-plaintext highlighter-rouge">Email</code> table.</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241217232926.png" width="100%" alt="figure">
<img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241217233251.png" width="100%" alt="figure"></p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241217233713.png" width="100%" alt="figure">
<img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241217233751.png" width="100%" alt="figure"></p>

<p>So the email address i</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>angel_candysalt@santaworkshopgeeseislands.org
</code></pre></div></div>

<p>Now let’s us it like in the text mentioned to retrieve the amount of recipients</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241217234309.png" width="100%" alt="figure">
<img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241217234326.png" width="100%" alt="figure"></p>

<p>Solution:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>31
</code></pre></div></div>

<p>The next question is about how to get how many distinct recipients for a specific sender are in the logs.
The sender to be analyzed is <code class="language-plaintext highlighter-rouge">twinkle_frostington@santaworkshopgeeseisland.org</code>.
This can be done with:</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241217234357.png" width="100%" alt="figure">
<img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241217234838.png" width="100%" alt="figure">
<img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241217234854.png" width="100%" alt="figure"></p>

<p>Solution</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>32
</code></pre></div></div>

<p>Ok, so Twinkle Frostington has written to 32 different recipients.
In the next question the task this gets broadened to websites.</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241218002238.png" width="100%" alt="figure">
<img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241218002305.png" width="100%" alt="figure"></p>

<p>So the Employees table contains IPs (look before). Get the IP from Twinkle from it.</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241218002503.png" width="100%" alt="figure"></p>

<p>And search it as source IP in the outbound network events as Twinkle should be the source for the website calls.
From the results lets check how many different urls Twinkle has visited</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241218002606.png" width="100%" alt="figure">
<img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241218002620.png" width="100%" alt="figure"></p>

<p>Solution:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>4
</code></pre></div></div>

<p>This was it for level 1, you reached level 2 ! :)
The first question here is how many domains visited contain the word “green”</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241218002651.png" width="100%" alt="figure">
<img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241218002842.png" width="100%" alt="figure">
<img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241218002924.png" width="100%" alt="figure">
<img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241218003032.png" width="100%" alt="figure"></p>

<p>The solution is</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>10
</code></pre></div></div>

<p>Now we have to handle two queries where the first is used as a variable in the second</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241218003113.png" width="100%" alt="figure">
<img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241218003540.png" width="100%" alt="figure">
<img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241218004034.png" width="100%" alt="figure">
<img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241218004141.png" width="100%" alt="figure"></p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241218004157.png" width="100%" alt="figure"></p>

<p>We got the solution:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>8
</code></pre></div></div>

<p>This is also the solution for silver Microsoft KC7 “KQL 101”:</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241221211957.png" width="100%" alt="figure">
<img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241221211907.png" width="100%" alt="figure"></p>

<p>To start level 2</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241218235240.png" width="100%" alt="figure"></p>

<p>just enter</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>surrender
</code></pre></div></div>

<p>This level is about attacks against Team Wombley.
The next question is more lengthy</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241218235351.png" width="100%" alt="figure">
<img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241218235413.png" width="100%" alt="figure"></p>

<p>So now there is no help anymore. You have to get the answer from what we learned already.
First let’s check what information you can get from the Email table:</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241218235628.png" width="100%" alt="figure"></p>

<p>There is a column verdict which labels an email from the spam filter as phishing or not
The keyword mentioned in the task to search for in the emails is “surrender”</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241219000723.png" width="100%" alt="figure"></p>

<p>Solution:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>surrender@northpolemail.com
</code></pre></div></div>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241219001035.png" width="100%" alt="figure"></p>

<p>To find the amount of elves from Team Wombley who received the email do</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241219001043.png" width="100%" alt="figure"></p>

<p>Solution:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>22
</code></pre></div></div>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241219222844.png" width="100%" alt="figure"></p>

<p>Mm, so how to find the filename? There is a column called <code class="language-plaintext highlighter-rouge">link</code> in the Email table which could fit:</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241219223912.png" width="100%" alt="figure"></p>

<p>So from all those links you can infer the solution:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Team_Wombley_Surrender.doc
</code></pre></div></div>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241219224111.png" width="100%" alt="figure"></p>

<p>Let’s use this snippet to find the patient zero, the first computer infected in Team Wombley</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241219224602.png" width="100%" alt="figure"></p>

<p>Solution:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Joyelle Tinseltoe
</code></pre></div></div>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241219224825.png" width="100%" alt="figure"></p>

<p>There are two variables to be found timestamp and hostname.
The timestamp can be used from the last query response:</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241219225434.png" width="100%" alt="figure"></p>

<p>The <code class="language-plaintext highlighter-rouge">ProcessEvents</code> table contains a column <code class="language-plaintext highlighter-rouge">hostname</code>.
Let’s search for the hostname from Joyelle Tinseltoe in this table.</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241219225645.png" width="100%" alt="figure">
<img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241219230009.png" width="100%" alt="figure"></p>

<p>The corresponding query gives us the solution</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241219230215.png" width="100%" alt="figure"></p>

<p>So this gives us</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>keylogger.exe
</code></pre></div></div>

<p>The next step is about getting the flag for the second challenge in the main Microsoft KC7 challenge
“Operation Surrender”. You have to encode the last solution <code class="language-plaintext highlighter-rouge">keylogger.exe</code></p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241219230306.png" width="100%" alt="figure">
<img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241219230317.png" width="100%" alt="figure">
<img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241219230600.png" width="100%" alt="figure"></p>

<p>Solution:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>a2V5bG9nZ2VyLmV4ZQ==
</code></pre></div></div>

<p>Enter this solution for part two in the Microsoft KC7 challenge “Operation Surrender”:</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241221212118.png" width="100%" alt="figure">
<img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241221212141.png" width="100%" alt="figure"></p>

<p>The last question for level 2</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241219230712.png" width="100%" alt="figure">
<img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241219230725.png" width="100%" alt="figure"></p>

<p>Just enter</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>snowfall
</code></pre></div></div>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241219230907.png" width="100%" alt="figure"></p>

<p>This finished level 2. Time to start level 3!</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241219230915.png" width="100%" alt="figure"></p>

<p>In contrast to the last level, level 3 is now about attacks against Team Alabaster.
It starts with the task to find the root of a password spraying against this team.</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241219230943.png" width="100%" alt="figure"></p>

<p>Let’s just use the snippet</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241219230954.png" width="100%" alt="figure">
<img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241219231304.png" width="100%" alt="figure"></p>

<p>So the source IP is:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>59.171.58.12
</code></pre></div></div>

<p>In the next question you have to identify into how many accounts were logged into successfully from
the attacker IP</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241219231558.png" width="100%" alt="figure"></p>

<p>If you check the <code class="language-plaintext highlighter-rouge">AuthenticationEvents</code> table you can see that there is a column which 
stores successful logins</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241219231605.png" width="100%" alt="figure"></p>

<p>Let’s check for the given IP <code class="language-plaintext highlighter-rouge">59.171.58.12</code> and list the hostnames connected to those successful logins</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241219231753.png" width="100%" alt="figure">
<img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241219232032.png" width="100%" alt="figure"></p>

<p>You now only have to count the hostnames together</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241219232055.png" width="100%" alt="figure"></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>19
</code></pre></div></div>

<p>Mm, this didn’t work for me. Ah, it’s not hostname it has to be username! Reason is because
at each hostname you can perhaps have multiple users who can log in.
Let’s try that</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241220231622.png" width="100%" alt="figure"></p>

<p>This worked! The solution is:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>23
</code></pre></div></div>

<p>The next task is about identifying a service externally available which was misused.</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241220231707.png" width="100%" alt="figure"></p>

<p>First I thought perhaps this can be identified using <code class="language-plaintext highlighter-rouge">InboundNetworkEvents</code> and the aforementioned
attacker source ip.</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241220232341.png" width="100%" alt="figure">
<img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241220232320.png" width="100%" alt="figure"></p>

<p>But to no avail. Next I focused on <code class="language-plaintext highlighter-rouge">ProcessEvents</code> and search the parent processes I could find</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241220235035.png" width="100%" alt="figure"></p>

<p>Oh, this is not so much! I wanted to analyze the services, so I thought <code class="language-plaintext highlighter-rouge">services.exe</code> or <a href="https://ss64.com/nt/sc.html" target="_blank" rel="noopener noreferrer">sc.exe</a>
is probably correct. I used that to filter for the underlying processes started:</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241221001514.png" width="100%" alt="figure"></p>

<p>This also lead to a dead end.
Finally, I came back to the <code class="language-plaintext highlighter-rouge">AuthenticationEvents</code> table from the task before and looked a deeper into it there.
If you inspect the column <code class="language-plaintext highlighter-rouge">description</code> it carefully you can see that <code class="language-plaintext highlighter-rouge">RDP</code> was used.</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241221185558.png" width="100%" alt="figure"></p>

<p>So this is the answer for the current question.</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241221185618.png" width="100%" alt="figure"></p>

<p>Ok, your task is to find this exfiltrated file!
What is the username for Alabaster`s laptop:</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241221192103.png" width="100%" alt="figure"></p>

<p>In the description there is a hint that says that you can narrow down the events
using the timestamp. I took the time around the results from the last solution</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241221192243.png" width="100%" alt="figure"></p>

<p>This yields to the solution:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Secret_Files.zip
</code></pre></div></div>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241221192410.png" width="100%" alt="figure"></p>

<p>So now the task is to find the file which encrypted the device.
For this you can use the same query from the last question</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241221193032.png" width="100%" alt="figure"></p>

<p>Solution:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>EncryptEverything.exe
</code></pre></div></div>

<p>In the next step you can catch the next flag and accomplish the third question 
“Operation Snowfall” for the Microsoft KC7 challenge.</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241221193050.png" width="100%" alt="figure">
<img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241221193358.png" width="100%" alt="figure"></p>

<p>Solution:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>RW5jcnlwdEV2ZXJ5dGhpbmcuZXhl
</code></pre></div></div>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241221212456.png" width="100%" alt="figure"></p>

<p>The fourth part starts with a simple string to enter</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241221193442.png" width="100%" alt="figure">Solution:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>stay frosty
</code></pre></div></div>

<p>This part starts to look into Emails from Noel Boetie</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241221193832.png" width="100%" alt="figure">
<img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241221195034.png" width="100%" alt="figure"></p>

<p>Solution:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>2024-12-12T14:48:55Z
</code></pre></div></div>

<p>You have to check when Noel clicked the link. For that you first need to identify the link and afterward can analyze the time linked to that.</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241221195103.png" width="100%" alt="figure">
<img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241221195319.png" width="100%" alt="figure"></p>

<p>The link in the email is:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>https://holidaybargainhunt.io/published/files/files/echo.exe
</code></pre></div></div>

<p>The corresponding table to connect is <code class="language-plaintext highlighter-rouge">OutboundNetworkEvents</code></p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241221195646.png" width="100%" alt="figure"></p>

<p>Solution:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>2024-12-12T15:13:55Z
</code></pre></div></div>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241221195819.png" width="100%" alt="figure"></p>

<p>Ok. To get the IP you can use the table <code class="language-plaintext highlighter-rouge">PassiveDns</code>. Passive DNS are historical DNS logs which you can 
use to analyze incidents.</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241221200026.png" width="100%" alt="figure"></p>

<p>Solution:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>182.56.23.122
</code></pre></div></div>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241221200102.png" width="100%" alt="figure"></p>

<p>This time you use the IP from the attacker server before to check if it was also used
to log in into the victim system. This could be if it was just one Kali server for example.
Let’s use the <code class="language-plaintext highlighter-rouge">AuthenticationEvents</code> table as mentioned.</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241221201536.png" width="100%" alt="figure"></p>

<p>Solution:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>WebApp-ElvesWorkshop
</code></pre></div></div>
<p>is the hostname in which the IP has logged in.</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241221201646.png" width="100%" alt="figure"></p>

<p>So now we know the hostname which was probably initially compromised. 
If you look in the <code class="language-plaintext highlighter-rouge">ProcessEvents</code> table for it, you get 8 entries</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241221203310.png" width="100%" alt="figure"></p>

<p>Solution:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Invoke-Mimikatz.ps1
</code></pre></div></div>
<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241221203405.png" width="100%" alt="figure"></p>

<p>If you look deeper in the ProcessEvents you can extract that the executed file was <code class="language-plaintext highlighter-rouge">echo.exe</code>.
And the first time this was executed is</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241221203734.png" width="100%" alt="figure"></p>

<p>Solution:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>2024-12-12T15:14:38Z
</code></pre></div></div>

<p>Oh, this was it for level 3!</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241221203808.png" width="100%" alt="figure"></p>

<p>Let’s start level 4 :)</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241221203828.png" width="100%" alt="figure"></p>

<p>Mm, domain …
The table <code class="language-plaintext highlighter-rouge">OutboundNetworkEvents</code> has a column <code class="language-plaintext highlighter-rouge">url</code> which contains all the urls
the users tried to reach from outside.</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241221204104.png" width="100%" alt="figure"></p>

<p>So the solution is:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>compromisedchristmastoys.com
</code></pre></div></div>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241221204208.png" width="100%" alt="figure"></p>

<p>Remember from questions 2-4 it was Noel Boetie who first clicked the phishing link. 
So lets first inspect which processes ran at this user which had this file <code class="language-plaintext highlighter-rouge">frosty.zip</code> used:</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241221204730.png" width="100%" alt="figure">
<img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241221204937.png" width="100%" alt="figure"></p>

<p>We can use the timestamp to look what happened in this time range</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241221205319.png" width="100%" alt="figure"></p>

<p>Solution:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>sqlwriter.exe
</code></pre></div></div>

<p>The solution can be extracted from the same log entry as the last answer</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241221205356.png" width="100%" alt="figure"></p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241221210156.png" width="100%" alt="figure"></p>

<p>Solution:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>frosty
</code></pre></div></div>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241221210228.png" width="100%" alt="figure"></p>

<p>Hey let’s get the badge for the complete module :)</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241221211336.png" width="100%" alt="figure"></p>

<p>Solution:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ZnJvc3R5
</code></pre></div></div>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241221211412.png" width="100%" alt="figure"></p>

<p>This is also the final solution for the fourth part in the Microsoft KC7 challenge “Echoes in the Frost”:</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241221212553.png" width="100%" alt="figure"></p>

<p>After you enter the solution you will have gold in the Microsoft KC7 challenge:</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241221212634.png" width="100%" alt="figure"></p>

<p>Next I moved to Act III</p>

<h1 id="act-iii">
<a class="anchor" href="#act-iii" aria-hidden="true"><span class="octicon octicon-link"></span></a>Act III</h1>

<p>Entering Act III a lot of new objectives get unlocked</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241222030412.png" width="100%" alt="figure"></p>

<p>And Santa appears and he seems to be very angry :)</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241222030433.png" width="100%" alt="figure"></p>

<h2 id="santa-vision">
<a class="anchor" href="#santa-vision" aria-hidden="true"><span class="octicon octicon-link"></span></a>Santa Vision</h2>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241222030609.png" width="100%" alt="figure">
<img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241222030619.png" width="100%" alt="figure"></p>

<p>If you go a little bit you come to Ribb Bonbowford:</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241222030710.png" width="100%" alt="figure">
<img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241222030817.png" width="100%" alt="figure">
<img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241222030903.png" width="100%" alt="figure">
<img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241222030946.png" width="100%" alt="figure">
<img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241222030957.png" width="100%" alt="figure">
<img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241223011738.png" width="100%" alt="figure"></p>

<p>The goals are</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241223011753.png" width="100%" alt="figure"></p>

<p>Ribb also delivers you with some hints</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241222031107.png" width="100%" alt="figure">
<img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241222031119.png" width="100%" alt="figure"></p>

<p>So this is a repo about a tool to analyze the file system jffs called <a href="https://github.com/onekey-sec/jefferson/" target="_blank" rel="noopener noreferrer">jefferson</a></p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241222031236.png" width="100%" alt="figure"></p>

<p>The technology used in this task seems to be <a href="https://en.wikipedia.org/wiki/MQTT" target="_blank" rel="noopener noreferrer">MQTT</a></p>

<p>If you open the application</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241222031410.png" width="100%" alt="figure"></p>

<p>There is a small crocodile in the lower right corner to click</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241222031459.png" width="100%" alt="figure"><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241222031510.png" width="100%" alt="figure"></p>

<p>The first link goes to</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241222031553.png" width="100%" alt="figure">
<img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241222031609.png" width="100%" alt="figure"></p>

<p>In this description the link GateXOR opens:</p>

<p><a href="https://www.youtube.com/watch?v=6JXRHZsV9u0" target="_blank" rel="noopener noreferrer">https://www.youtube.com/watch?v=6JXRHZsV9u0</a></p>

<p>The video there plays the american pronounciation of “gator”:</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241222031735.png" width="100%" alt="figure"></p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241222031703.png" width="100%" alt="figure"></p>

<p>The second link “Time Travel” opens a console and starts a server:</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241222032000.png" width="100%" alt="figure"></p>

<p>If you scan this target you get</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>➜  santavision <span class="nb">sudo </span>nmap <span class="nt">-A</span> 34.135.21.17  
Starting Nmap 7.94SVN <span class="o">(</span> https://nmap.org <span class="o">)</span> at 2024-12-22 03:21 CET
Nmap scan report <span class="k">for </span>17.21.135.34.bc.googleusercontent.com <span class="o">(</span>34.135.21.17<span class="o">)</span>
Host is up <span class="o">(</span>0.13s latency<span class="o">)</span><span class="nb">.</span>
Not shown: 997 closed tcp ports <span class="o">(</span>reset<span class="o">)</span>
PORT     STATE SERVICE     VERSION
22/tcp   open  ssh         OpenSSH 9.2p1 Debian 2+deb12u3 <span class="o">(</span>protocol 2.0<span class="o">)</span>
| ssh-hostkey: 
|   256 a9:29:8e:6b:08:91:72:8a:cb:d1:e8:d4:f4:af:5f:c2 <span class="o">(</span>ECDSA<span class="o">)</span>
|_  256 f0:f8:c0:5e:5c:c0:bb:81:99:34:0f:47:35:10:23:f7 <span class="o">(</span>ED25519<span class="o">)</span>
8000/tcp open  http-alt    gunicorn
|_http-title: Santa Vision
|_http-server-header: gunicorn
| fingerprint-strings: 
|   FourOhFourRequest: 
|     HTTP/1.0 404 NOT FOUND
|     Server: gunicorn
|     Date: Sun, 22 Dec 2024 02:21:53 GMT
|     Connection: close
|     Content-Type: text/html<span class="p">;</span> <span class="nv">charset</span><span class="o">=</span>utf-8
|     Content-Length: 1820
|     Vary: Cookie
|     &lt;<span class="o">!</span>DOCTYPE html&gt;
|     &lt;html <span class="nv">lang</span><span class="o">=</span><span class="s2">"en"</span><span class="o">&gt;</span>
|     &lt;<span class="nb">head</span><span class="o">&gt;</span>
|     &lt;meta <span class="nv">charset</span><span class="o">=</span><span class="s2">"utf-8"</span><span class="o">&gt;</span>
|     &lt;title&gt;Santa Vision&lt;/title&gt;
|     &lt;<span class="o">!</span><span class="nt">--</span> meta <span class="nt">--</span><span class="o">&gt;</span>
|     &lt;meta <span class="nv">name</span><span class="o">=</span><span class="s2">"description"</span> <span class="nv">content</span><span class="o">=</span><span class="s2">""</span><span class="o">&gt;</span>
|     &lt;meta <span class="nv">name</span><span class="o">=</span><span class="s2">"author"</span> <span class="nv">content</span><span class="o">=</span><span class="s2">""</span><span class="o">&gt;</span>
|     &lt;meta <span class="nv">name</span><span class="o">=</span><span class="s2">"viewport"</span> <span class="nv">content</span><span class="o">=</span><span class="s2">"width=device-width,initial-scale=1"</span><span class="o">&gt;</span>
|     &lt;<span class="o">!</span><span class="nt">--</span> styles <span class="nt">--</span><span class="o">&gt;</span>
|     &lt;<span class="o">!</span><span class="nt">--</span> CSS only <span class="nt">--</span><span class="o">&gt;</span>
|     &lt;<span class="nb">link </span><span class="nv">href</span><span class="o">=</span><span class="s2">"https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/css/bootstrap.min.css"</span> <span class="nv">rel</span><span class="o">=</span><span class="s2">"stylesheet"</span> <span class="nv">integrity</span><span class="o">=</span><span class="s2">"sha384-gH2yIJqKdNHPEq0n4Mqa/HGKIhSkIHeL5AyhkYV8i59U5AR6csBvApHHNl/vI1Bx"</span> <span class="nv">crossorigin</span><span class="o">=</span><span class="s2">"anonymous"</span><span class="o">&gt;</span>
|     &lt;<span class="nb">link </span><span class="nv">rel</span><span class="o">=</span><span class="s2">"stylesheet"</span> <span class="nv">href</span><span class="o">=</span><span class="s2">"/static/css/styles.css"</span><span class="o">&gt;</span>
|     &lt;/head&gt;
|     &lt;body&gt;
|     &lt;<span class="o">!</span><span class="nt">--</span> Navigation <span class="nt">--</span><span class="o">&gt;</span>
|     &lt;header <span class="nv">class</span><span class="o">=</span><span class="s2">"p-3 mb-3 text-bg-dark"</span><span class="o">&gt;</span>
|     &lt;div <span class="nv">class</span><span class="o">=</span><span class="s2">"container"</span><span class="o">&gt;</span>
|     &lt;div <span class="nv">class</span><span class="o">=</span><span class="s2">"d-flex flex-
|   GenericLines: 
|     HTTP/1.1 400 Bad Request
|     Connection: close
|     Content-Type: text/html
|     Content-Length: 193
|     &lt;html&gt;
|     &lt;head&gt;
|     &lt;title&gt;Bad Request&lt;/title&gt;
|     &lt;/head&gt;
|     &lt;body&gt;
|     &lt;h1&gt;&lt;p&gt;Bad Request&lt;/p&gt;&lt;/h1&gt;
|     Invalid Request Line &amp;#x27;Invalid HTTP request line: &amp;#x27;&amp;#x27;&amp;#x27;
|     &lt;/body&gt;
|     &lt;/html&gt;
|   GetRequest: 
|     HTTP/1.0 200 OK
|     Server: gunicorn
|     Date: Sun, 22 Dec 2024 02:21:48 GMT
|     Connection: close
|     Content-Type: text/html; charset=utf-8
|     Content-Length: 2946
|     Vary: Cookie
|     Set-Cookie: svCookie=-_GrbgUMaRrs_KzAshOPFe4OztUSHnx-Y38to7B2mbg; Expires=Wed, 22 Jan 2025 02:21:48 GMT; HttpOnly; Path=/
|     &lt;!DOCTYPE html&gt;
|     &lt;html lang="</span>en<span class="s2">"&gt;
|     &lt;head&gt;
|     &lt;meta charset="</span>utf-8<span class="s2">"&gt;
|     &lt;title&gt;Santa Vision&lt;/title&gt;
|     &lt;!-- meta --&gt;
|     &lt;meta name="</span>description<span class="s2">" content=""&gt;
|     &lt;meta name="</span>author<span class="s2">" content=""&gt;
|     &lt;meta name="</span>viewport<span class="s2">" content="</span><span class="nv">width</span><span class="o">=</span>device-width,initial-scale<span class="o">=</span>1<span class="s2">"&gt;
|     &lt;!-- styles --&gt;
|     &lt;!-- CSS only --&gt;
|     &lt;link href="</span>https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/css/bootstrap.min.css<span class="s2">" rel="</span>stylesheet<span class="s2">" integrity="</span>sha384-gH2yIJqKdNHPEq0n4Mqa/HGKIhSkIHeL5AyhkYV8i59U5AR6csBvApHHNl/vI1Bx<span class="s2">" crossorigin="</span>anonymous<span class="s2">"&gt;
|     &lt;link rel="</span>stylesheet<span class="s2">" href="</span>/static/css/styles.css<span class="s2">"&gt;
|     &lt;/head&gt;
|_    &lt;body&gt;
9001/tcp open  tor-orport?
	| fingerprint-strings: 
	|   JavaRMI, Radmin, SSLSessionReq, SSLv23SessionReq, TLSSessionReq, mongodb, tarantool: 
|     HTTP/1.0 403 Forbidden
|     content-type: text/html
|     content-length: 173
|_    &lt;html&gt;&lt;head&gt;&lt;meta charset=utf-8 http-equiv="</span>Content-Language<span class="s2">" content="</span>en<span class="s2">"/&gt;&lt;link rel="</span>stylesheet<span class="s2">" type="</span>text/css<span class="s2">" href="</span>/error.css<span class="s2">"/&gt;&lt;/head&gt;&lt;body&gt;&lt;h1&gt;403&lt;/h1&gt;&lt;/body&gt;&lt;/html&gt;
2 services unrecognized despite returning data. If you know the service/version, please submit the following fingerprints at https://nmap.org/cgi-bin/submit.cgi?new-service :
==============NEXT SERVICE FINGERPRINT (SUBMIT INDIVIDUALLY)==============
SF-Port8000-TCP:V=7.94SVN%I=7%D=12/22%Time=676777BB%P=x86_64-pc-linux-gnu%
SF:r(GenericLines,11E,"</span>HTTP/1<span class="se">\.</span>1<span class="se">\x</span>20400<span class="se">\x</span>20Bad<span class="se">\x</span>20Request<span class="se">\r\n</span>Connection:<span class="se">\x</span>
SF:20close<span class="se">\r\n</span>Content-Type:<span class="se">\x</span>20text/html<span class="se">\r\n</span>Content-Length:<span class="se">\x</span>20193<span class="se">\r\n\r\n</span>
SF:&lt;html&gt;<span class="se">\n\x</span>20<span class="se">\x</span>20&lt;<span class="nb">head</span><span class="o">&gt;</span><span class="se">\n\x</span>20<span class="se">\x</span>20<span class="se">\x</span>20<span class="se">\x</span>20&lt;title&gt;Bad<span class="se">\x</span>20Request&lt;/title&gt;<span class="se">\n</span>
SF:<span class="se">\x</span>20<span class="se">\x</span>20&lt;/head&gt;<span class="se">\n\x</span>20<span class="se">\x</span>20&lt;body&gt;<span class="se">\n\x</span>20<span class="se">\x</span>20<span class="se">\x</span>20<span class="se">\x</span>20&lt;h1&gt;&lt;p&gt;Bad<span class="se">\x</span>20Request&lt;
SF:/p&gt;&lt;/h1&gt;<span class="se">\n\x</span>20<span class="se">\x</span>20<span class="se">\x</span>20<span class="se">\x</span>20Invalid<span class="se">\x</span>20Request<span class="se">\x</span>20Line<span class="se">\x</span>20&amp;#x27<span class="p">;</span>Invalid<span class="se">\x</span>
SF:20HTTP<span class="se">\x</span>20request<span class="se">\x</span>20line:<span class="se">\x</span>20&amp;#x27<span class="p">;</span>&amp;#x27<span class="p">;</span>&amp;#x27<span class="p">;</span><span class="se">\n\x</span>20<span class="se">\x</span>20&lt;/body&gt;<span class="se">\n</span>&lt;/ht
SF:ml&gt;<span class="se">\n</span><span class="s2">")%r(GetRequest,CA6,"</span>HTTP/1<span class="se">\.</span>0<span class="se">\x</span>20200<span class="se">\x</span>20OK<span class="se">\r\n</span>Server:<span class="se">\x</span>20gunicorn
SF:<span class="se">\r\n</span>Date:<span class="se">\x</span>20Sun,<span class="se">\x</span>2022<span class="se">\x</span>20Dec<span class="se">\x</span>202024<span class="se">\x</span>2002:21:48<span class="se">\x</span>20GMT<span class="se">\r\n</span>Connection
SF::<span class="se">\x</span>20close<span class="se">\r\n</span>Content-Type:<span class="se">\x</span>20text/html<span class="p">;</span><span class="se">\x</span><span class="nv">20charset</span><span class="o">=</span>utf-8<span class="se">\r\n</span>Content-L
SF:ength:<span class="se">\x</span>202946<span class="se">\r\n</span>Vary:<span class="se">\x</span>20Cookie<span class="se">\r\n</span>Set-Cookie:<span class="se">\x</span><span class="nv">20svCookie</span><span class="o">=</span><span class="nt">-_GrbgUMaR</span>
SF:rs_KzAshOPFe4OztUSHnx-Y38to7B2mbg<span class="p">;</span><span class="se">\x</span><span class="nv">20Expires</span><span class="o">=</span>Wed,<span class="se">\x</span>2022<span class="se">\x</span>20Jan<span class="se">\x</span>202025
SF:<span class="se">\x</span>2002:21:48<span class="se">\x</span>20GMT<span class="p">;</span><span class="se">\x</span>20HttpOnly<span class="p">;</span><span class="se">\x</span><span class="nv">20Path</span><span class="o">=</span>/<span class="se">\r\n\r\n</span>&lt;<span class="o">!</span>DOCTYPE<span class="se">\x</span>20html&gt;<span class="se">\n</span>
SF:&lt;html<span class="se">\x</span><span class="nv">20lang</span><span class="o">=</span><span class="se">\"</span>en<span class="se">\"</span><span class="o">&gt;</span><span class="se">\n\x</span>20<span class="se">\x</span>20&lt;<span class="nb">head</span><span class="o">&gt;</span><span class="se">\n\x</span>20<span class="se">\x</span>20<span class="se">\x</span>20<span class="se">\x</span>20&lt;meta<span class="se">\x</span>20charset
SF:<span class="o">=</span><span class="se">\"</span>utf-8<span class="se">\"</span><span class="o">&gt;</span><span class="se">\n\x</span>20<span class="se">\x</span>20<span class="se">\x</span>20<span class="se">\x</span>20&lt;title&gt;Santa<span class="se">\x</span>20Vision&lt;/title&gt;<span class="se">\n\x</span>20<span class="se">\x</span>20<span class="se">\x</span>
SF:20<span class="se">\x</span>20&lt;<span class="o">!</span><span class="nt">--</span><span class="se">\x</span>20meta<span class="se">\x</span>20--&gt;<span class="se">\n\x</span>20<span class="se">\x</span>20<span class="se">\x</span>20<span class="se">\x</span>20&lt;meta<span class="se">\x</span><span class="nv">20name</span><span class="o">=</span><span class="se">\"</span>description<span class="se">\</span>
SF:<span class="s2">"</span><span class="se">\x</span><span class="s2">20content=</span><span class="se">\"\"</span><span class="s2">&gt;</span><span class="se">\n\x</span><span class="s2">20</span><span class="se">\x</span><span class="s2">20</span><span class="se">\x</span><span class="s2">20</span><span class="se">\x</span><span class="s2">20&lt;meta</span><span class="se">\x</span><span class="s2">20name=</span><span class="se">\"</span><span class="s2">author</span><span class="se">\"\x</span><span class="s2">20content
SF:=</span><span class="se">\"\"</span><span class="s2">&gt;</span><span class="se">\n\x</span><span class="s2">20</span><span class="se">\x</span><span class="s2">20</span><span class="se">\x</span><span class="s2">20</span><span class="se">\x</span><span class="s2">20&lt;meta</span><span class="se">\x</span><span class="s2">20name=</span><span class="se">\"</span><span class="s2">viewport</span><span class="se">\"\x</span><span class="s2">20content=</span><span class="se">\"</span><span class="s2">width=d
SF:evice-width,initial-scale=1</span><span class="se">\"</span><span class="s2">&gt;</span><span class="se">\n\x</span><span class="s2">20</span><span class="se">\x</span><span class="s2">20</span><span class="se">\x</span><span class="s2">20</span><span class="se">\x</span><span class="s2">20&lt;!--</span><span class="se">\x</span><span class="s2">20styles</span><span class="se">\x</span><span class="s2">20--&gt;</span><span class="se">\n</span><span class="s2">
SF:</span><span class="se">\x</span><span class="s2">20</span><span class="se">\x</span><span class="s2">20</span><span class="se">\x</span><span class="s2">20</span><span class="se">\x</span><span class="s2">20&lt;!--</span><span class="se">\x</span><span class="s2">20CSS</span><span class="se">\x</span><span class="s2">20only</span><span class="se">\x</span><span class="s2">20--&gt;</span><span class="se">\n\x</span><span class="s2">20</span><span class="se">\x</span><span class="s2">20</span><span class="se">\x</span><span class="s2">20</span><span class="se">\x</span><span class="s2">20&lt;link</span><span class="se">\x</span><span class="s2">20hr
SF:ef=</span><span class="se">\"</span><span class="s2">https://cdn</span><span class="se">\.</span><span class="s2">jsdelivr</span><span class="se">\.</span><span class="s2">net/npm/bootstrap@5</span><span class="se">\.</span><span class="s2">2</span><span class="se">\.</span><span class="s2">0/dist/css/bootstra
SF:p</span><span class="se">\.</span><span class="s2">min</span><span class="se">\.</span><span class="s2">css</span><span class="se">\"\x</span><span class="s2">20rel=</span><span class="se">\"</span><span class="s2">stylesheet</span><span class="se">\"\x</span><span class="s2">20integrity=</span><span class="se">\"</span><span class="s2">sha384-gH2yIJqKdNHPE
SF:q0n4Mqa/HGKIhSkIHeL5AyhkYV8i59U5AR6csBvApHHNl/vI1Bx</span><span class="se">\"\x</span><span class="s2">20crossorigin=</span><span class="se">\"</span><span class="s2">
SF:anonymous</span><span class="se">\"</span><span class="s2">&gt;</span><span class="se">\n\x</span><span class="s2">20</span><span class="se">\x</span><span class="s2">20</span><span class="se">\x</span><span class="s2">20</span><span class="se">\x</span><span class="s2">20&lt;link</span><span class="se">\x</span><span class="s2">20rel=</span><span class="se">\"</span><span class="s2">stylesheet</span><span class="se">\"\x</span><span class="s2">20href=</span><span class="se">\"</span><span class="s2">/st
SF:atic/css/styles</span><span class="se">\.</span><span class="s2">css</span><span class="se">\"</span><span class="s2">&gt;</span><span class="se">\n\x</span><span class="s2">20</span><span class="se">\x</span><span class="s2">20</span><span class="se">\x</span><span class="s2">20</span><span class="se">\x</span><span class="s2">20</span><span class="se">\n\x</span><span class="s2">20</span><span class="se">\x</span><span class="s2">20&lt;/head&gt;</span><span class="se">\n\x</span><span class="s2">20</span><span class="se">\x</span><span class="s2">20&lt;bo
SF:dy&gt;</span><span class="se">\n\x</span><span class="s2">20"</span><span class="o">)</span>%r<span class="o">(</span>FourOhFourRequest,7CC,<span class="s2">"HTTP/1</span><span class="se">\.</span><span class="s2">0</span><span class="se">\x</span><span class="s2">20404</span><span class="se">\x</span><span class="s2">20NOT</span><span class="se">\x</span><span class="s2">20FOUND</span><span class="se">\r</span><span class="s2">
SF:</span><span class="se">\n</span><span class="s2">Server:</span><span class="se">\x</span><span class="s2">20gunicorn</span><span class="se">\r\n</span><span class="s2">Date:</span><span class="se">\x</span><span class="s2">20Sun,</span><span class="se">\x</span><span class="s2">2022</span><span class="se">\x</span><span class="s2">20Dec</span><span class="se">\x</span><span class="s2">202024</span><span class="se">\x</span><span class="s2">2002:21:53
SF:</span><span class="se">\x</span><span class="s2">20GMT</span><span class="se">\r\n</span><span class="s2">Connection:</span><span class="se">\x</span><span class="s2">20close</span><span class="se">\r\n</span><span class="s2">Content-Type:</span><span class="se">\x</span><span class="s2">20text/html;</span><span class="se">\x</span><span class="s2">20chars
SF:et=utf-8</span><span class="se">\r\n</span><span class="s2">Content-Length:</span><span class="se">\x</span><span class="s2">201820</span><span class="se">\r\n</span><span class="s2">Vary:</span><span class="se">\x</span><span class="s2">20Cookie</span><span class="se">\r\n\r\n</span><span class="s2">&lt;!DOCTYPE
SF:</span><span class="se">\x</span><span class="s2">20html&gt;</span><span class="se">\n</span><span class="s2">&lt;html</span><span class="se">\x</span><span class="s2">20lang=</span><span class="se">\"</span><span class="s2">en</span><span class="se">\"</span><span class="s2">&gt;</span><span class="se">\n\x</span><span class="s2">20</span><span class="se">\x</span><span class="s2">20&lt;head&gt;</span><span class="se">\n\x</span><span class="s2">20</span><span class="se">\x</span><span class="s2">20</span><span class="se">\x</span><span class="s2">20</span><span class="se">\x</span><span class="s2">20&lt;meta
SF:</span><span class="se">\x</span><span class="s2">20charset=</span><span class="se">\"</span><span class="s2">utf-8</span><span class="se">\"</span><span class="s2">&gt;</span><span class="se">\n\x</span><span class="s2">20</span><span class="se">\x</span><span class="s2">20</span><span class="se">\x</span><span class="s2">20</span><span class="se">\x</span><span class="s2">20&lt;title&gt;Santa</span><span class="se">\x</span><span class="s2">20Vision&lt;/title&gt;</span><span class="se">\</span><span class="s2">
SF:n</span><span class="se">\x</span><span class="s2">20</span><span class="se">\x</span><span class="s2">20</span><span class="se">\x</span><span class="s2">20</span><span class="se">\x</span><span class="s2">20&lt;!--</span><span class="se">\x</span><span class="s2">20meta</span><span class="se">\x</span><span class="s2">20--&gt;</span><span class="se">\n\x</span><span class="s2">20</span><span class="se">\x</span><span class="s2">20</span><span class="se">\x</span><span class="s2">20</span><span class="se">\x</span><span class="s2">20&lt;meta</span><span class="se">\x</span><span class="s2">20name=</span><span class="se">\"</span><span class="s2">d
SF:escription</span><span class="se">\"\x</span><span class="s2">20content=</span><span class="se">\"\"</span><span class="s2">&gt;</span><span class="se">\n\x</span><span class="s2">20</span><span class="se">\x</span><span class="s2">20</span><span class="se">\x</span><span class="s2">20</span><span class="se">\x</span><span class="s2">20&lt;meta</span><span class="se">\x</span><span class="s2">20name=</span><span class="se">\"</span><span class="s2">author</span><span class="se">\"</span><span class="s2">
SF:</span><span class="se">\x</span><span class="s2">20content=</span><span class="se">\"\"</span><span class="s2">&gt;</span><span class="se">\n\x</span><span class="s2">20</span><span class="se">\x</span><span class="s2">20</span><span class="se">\x</span><span class="s2">20</span><span class="se">\x</span><span class="s2">20&lt;meta</span><span class="se">\x</span><span class="s2">20name=</span><span class="se">\"</span><span class="s2">viewport</span><span class="se">\"\x</span><span class="s2">20conten
SF:t=</span><span class="se">\"</span><span class="s2">width=device-width,initial-scale=1</span><span class="se">\"</span><span class="s2">&gt;</span><span class="se">\n\x</span><span class="s2">20</span><span class="se">\x</span><span class="s2">20</span><span class="se">\x</span><span class="s2">20</span><span class="se">\x</span><span class="s2">20&lt;!--</span><span class="se">\x</span><span class="s2">20styl
SF:es</span><span class="se">\x</span><span class="s2">20--&gt;</span><span class="se">\n\x</span><span class="s2">20</span><span class="se">\x</span><span class="s2">20</span><span class="se">\x</span><span class="s2">20</span><span class="se">\x</span><span class="s2">20&lt;!--</span><span class="se">\x</span><span class="s2">20CSS</span><span class="se">\x</span><span class="s2">20only</span><span class="se">\x</span><span class="s2">20--&gt;</span><span class="se">\n\x</span><span class="s2">20</span><span class="se">\x</span><span class="s2">20</span><span class="se">\x</span><span class="s2">20</span><span class="se">\x</span><span class="s2">20
SF:&lt;link</span><span class="se">\x</span><span class="s2">20href=</span><span class="se">\"</span><span class="s2">https://cdn</span><span class="se">\.</span><span class="s2">jsdelivr</span><span class="se">\.</span><span class="s2">net/npm/bootstrap@5</span><span class="se">\.</span><span class="s2">2</span><span class="se">\.</span><span class="s2">0/dist/c
SF:ss/bootstrap</span><span class="se">\.</span><span class="s2">min</span><span class="se">\.</span><span class="s2">css</span><span class="se">\"\x</span><span class="s2">20rel=</span><span class="se">\"</span><span class="s2">stylesheet</span><span class="se">\"\x</span><span class="s2">20integrity=</span><span class="se">\"</span><span class="s2">sha384-gH
SF:2yIJqKdNHPEq0n4Mqa/HGKIhSkIHeL5AyhkYV8i59U5AR6csBvApHHNl/vI1Bx</span><span class="se">\"\x</span><span class="s2">20cro
SF:ssorigin=</span><span class="se">\"</span><span class="s2">anonymous</span><span class="se">\"</span><span class="s2">&gt;</span><span class="se">\n\x</span><span class="s2">20</span><span class="se">\x</span><span class="s2">20</span><span class="se">\x</span><span class="s2">20</span><span class="se">\x</span><span class="s2">20&lt;link</span><span class="se">\x</span><span class="s2">20rel=</span><span class="se">\"</span><span class="s2">stylesheet</span><span class="se">\"\x</span><span class="s2">2
SF:0href=</span><span class="se">\"</span><span class="s2">/static/css/styles</span><span class="se">\.</span><span class="s2">css</span><span class="se">\"</span><span class="s2">&gt;</span><span class="se">\n\x</span><span class="s2">20</span><span class="se">\x</span><span class="s2">20</span><span class="se">\x</span><span class="s2">20</span><span class="se">\x</span><span class="s2">20</span><span class="se">\n\x</span><span class="s2">20</span><span class="se">\x</span><span class="s2">20&lt;/head&gt;</span><span class="se">\n</span><span class="s2">
SF:</span><span class="se">\x</span><span class="s2">20</span><span class="se">\x</span><span class="s2">20&lt;body&gt;</span><span class="se">\n\x</span><span class="s2">20</span><span class="se">\x</span><span class="s2">20</span><span class="se">\x</span><span class="s2">20</span><span class="se">\x</span><span class="s2">20&lt;!--</span><span class="se">\x</span><span class="s2">20Navigation</span><span class="se">\x</span><span class="s2">20--&gt;</span><span class="se">\n</span><span class="s2">&lt;header</span><span class="se">\x</span><span class="s2">20c
SF:lass=</span><span class="se">\"</span><span class="s2">p-3</span><span class="se">\x</span><span class="s2">20mb-3</span><span class="se">\x</span><span class="s2">20text-bg-dark</span><span class="se">\"</span><span class="s2">&gt;</span><span class="se">\n\x</span><span class="s2">20</span><span class="se">\x</span><span class="s2">20&lt;div</span><span class="se">\x</span><span class="s2">20class=</span><span class="se">\"</span><span class="s2">containe
SF:r</span><span class="se">\"</span><span class="s2">&gt;</span><span class="se">\n\x</span><span class="s2">20</span><span class="se">\x</span><span class="s2">20</span><span class="se">\x</span><span class="s2">20</span><span class="se">\x</span><span class="s2">20&lt;div</span><span class="se">\x</span><span class="s2">20class=</span><span class="se">\"</span><span class="s2">d-flex</span><span class="se">\x</span><span class="s2">20flex-"</span><span class="o">)</span><span class="p">;</span>
<span class="o">==============</span>NEXT SERVICE FINGERPRINT <span class="o">(</span>SUBMIT INDIVIDUALLY<span class="o">)==============</span>
SF-Port9001-TCP:V<span class="o">=</span>7.94SVN%I<span class="o">=</span>7%D<span class="o">=</span>12/22%Time<span class="o">=</span>676777BC%P<span class="o">=</span>x86_64-pc-linux-gnu%
SF:r<span class="o">(</span>SSLSessionReq,F5,<span class="s2">"HTTP/1</span><span class="se">\.</span><span class="s2">0</span><span class="se">\x</span><span class="s2">20403</span><span class="se">\x</span><span class="s2">20Forbidden</span><span class="se">\r\n</span><span class="s2">content-type:</span><span class="se">\x</span><span class="s2">20t
SF:ext/html</span><span class="se">\r\n</span><span class="s2">content-length:</span><span class="se">\x</span><span class="s2">20173</span><span class="se">\r\n\r\n</span><span class="s2">&lt;html&gt;&lt;head&gt;&lt;meta</span><span class="se">\x</span><span class="s2">20charset=
SF:utf-8</span><span class="se">\x</span><span class="s2">20http-equiv=</span><span class="se">\"</span><span class="s2">Content-Language</span><span class="se">\"\x</span><span class="s2">20content=</span><span class="se">\"</span><span class="s2">en</span><span class="se">\"</span><span class="s2">/&gt;&lt;link</span><span class="se">\x</span><span class="s2">20re
SF:l=</span><span class="se">\"</span><span class="s2">stylesheet</span><span class="se">\"\x</span><span class="s2">20type=</span><span class="se">\"</span><span class="s2">text/css</span><span class="se">\"\x</span><span class="s2">20href=</span><span class="se">\"</span><span class="s2">/error</span><span class="se">\.</span><span class="s2">css</span><span class="se">\"</span><span class="s2">/&gt;&lt;/head&gt;&lt;
SF:body&gt;&lt;h1&gt;403&lt;/h1&gt;&lt;/body&gt;&lt;/html&gt;"</span><span class="o">)</span>%r<span class="o">(</span>TLSSessionReq,F5,<span class="s2">"HTTP/1</span><span class="se">\.</span><span class="s2">0</span><span class="se">\x</span><span class="s2">20403</span><span class="se">\</span><span class="s2">
SF:x20Forbidden</span><span class="se">\r\n</span><span class="s2">content-type:</span><span class="se">\x</span><span class="s2">20text/html</span><span class="se">\r\n</span><span class="s2">content-length:</span><span class="se">\x</span><span class="s2">20173</span><span class="se">\r\</span><span class="s2">
SF:n</span><span class="se">\r\n</span><span class="s2">&lt;html&gt;&lt;head&gt;&lt;meta</span><span class="se">\x</span><span class="s2">20charset=utf-8</span><span class="se">\x</span><span class="s2">20http-equiv=</span><span class="se">\"</span><span class="s2">Content-Languag
SF:e</span><span class="se">\"\x</span><span class="s2">20content=</span><span class="se">\"</span><span class="s2">en</span><span class="se">\"</span><span class="s2">/&gt;&lt;link</span><span class="se">\x</span><span class="s2">20rel=</span><span class="se">\"</span><span class="s2">stylesheet</span><span class="se">\"\x</span><span class="s2">20type=</span><span class="se">\"</span><span class="s2">text/css</span><span class="se">\"</span><span class="s2">
SF:</span><span class="se">\x</span><span class="s2">20href=</span><span class="se">\"</span><span class="s2">/error</span><span class="se">\.</span><span class="s2">css</span><span class="se">\"</span><span class="s2">/&gt;&lt;/head&gt;&lt;body&gt;&lt;h1&gt;403&lt;/h1&gt;&lt;/body&gt;&lt;/html&gt;"</span><span class="o">)</span>%r<span class="o">(</span>S
SF:SLv23SessionReq,F5,<span class="s2">"HTTP/1</span><span class="se">\.</span><span class="s2">0</span><span class="se">\x</span><span class="s2">20403</span><span class="se">\x</span><span class="s2">20Forbidden</span><span class="se">\r\n</span><span class="s2">content-type:</span><span class="se">\x</span><span class="s2">20t
SF:ext/html</span><span class="se">\r\n</span><span class="s2">content-length:</span><span class="se">\x</span><span class="s2">20173</span><span class="se">\r\n\r\n</span><span class="s2">&lt;html&gt;&lt;head&gt;&lt;meta</span><span class="se">\x</span><span class="s2">20charset=
SF:utf-8</span><span class="se">\x</span><span class="s2">20http-equiv=</span><span class="se">\"</span><span class="s2">Content-Language</span><span class="se">\"\x</span><span class="s2">20content=</span><span class="se">\"</span><span class="s2">en</span><span class="se">\"</span><span class="s2">/&gt;&lt;link</span><span class="se">\x</span><span class="s2">20re
SF:l=</span><span class="se">\"</span><span class="s2">stylesheet</span><span class="se">\"\x</span><span class="s2">20type=</span><span class="se">\"</span><span class="s2">text/css</span><span class="se">\"\x</span><span class="s2">20href=</span><span class="se">\"</span><span class="s2">/error</span><span class="se">\.</span><span class="s2">css</span><span class="se">\"</span><span class="s2">/&gt;&lt;/head&gt;&lt;
SF:body&gt;&lt;h1&gt;403&lt;/h1&gt;&lt;/body&gt;&lt;/html&gt;"</span><span class="o">)</span>%r<span class="o">(</span>JavaRMI,F5,<span class="s2">"HTTP/1</span><span class="se">\.</span><span class="s2">0</span><span class="se">\x</span><span class="s2">20403</span><span class="se">\x</span><span class="s2">20For
SF:bidden</span><span class="se">\r\n</span><span class="s2">content-type:</span><span class="se">\x</span><span class="s2">20text/html</span><span class="se">\r\n</span><span class="s2">content-length:</span><span class="se">\x</span><span class="s2">20173</span><span class="se">\r\n\r\n</span><span class="s2">&lt;
SF:html&gt;&lt;head&gt;&lt;meta</span><span class="se">\x</span><span class="s2">20charset=utf-8</span><span class="se">\x</span><span class="s2">20http-equiv=</span><span class="se">\"</span><span class="s2">Content-Language</span><span class="se">\"\x</span><span class="s2">2
SF:0content=</span><span class="se">\"</span><span class="s2">en</span><span class="se">\"</span><span class="s2">/&gt;&lt;link</span><span class="se">\x</span><span class="s2">20rel=</span><span class="se">\"</span><span class="s2">stylesheet</span><span class="se">\"\x</span><span class="s2">20type=</span><span class="se">\"</span><span class="s2">text/css</span><span class="se">\"\x</span><span class="s2">20hr
SF:ef=</span><span class="se">\"</span><span class="s2">/error</span><span class="se">\.</span><span class="s2">css</span><span class="se">\"</span><span class="s2">/&gt;&lt;/head&gt;&lt;body&gt;&lt;h1&gt;403&lt;/h1&gt;&lt;/body&gt;&lt;/html&gt;"</span><span class="o">)</span>%r<span class="o">(</span>Radmin,
SF:F5,<span class="s2">"HTTP/1</span><span class="se">\.</span><span class="s2">0</span><span class="se">\x</span><span class="s2">20403</span><span class="se">\x</span><span class="s2">20Forbidden</span><span class="se">\r\n</span><span class="s2">content-type:</span><span class="se">\x</span><span class="s2">20text/html</span><span class="se">\r\n</span><span class="s2">cont
SF:ent-length:</span><span class="se">\x</span><span class="s2">20173</span><span class="se">\r\n\r\n</span><span class="s2">&lt;html&gt;&lt;head&gt;&lt;meta</span><span class="se">\x</span><span class="s2">20charset=utf-8</span><span class="se">\x</span><span class="s2">20http-eq
SF:uiv=</span><span class="se">\"</span><span class="s2">Content-Language</span><span class="se">\"\x</span><span class="s2">20content=</span><span class="se">\"</span><span class="s2">en</span><span class="se">\"</span><span class="s2">/&gt;&lt;link</span><span class="se">\x</span><span class="s2">20rel=</span><span class="se">\"</span><span class="s2">stylesheet</span><span class="se">\"</span><span class="s2">
SF:</span><span class="se">\x</span><span class="s2">20type=</span><span class="se">\"</span><span class="s2">text/css</span><span class="se">\"\x</span><span class="s2">20href=</span><span class="se">\"</span><span class="s2">/error</span><span class="se">\.</span><span class="s2">css</span><span class="se">\"</span><span class="s2">/&gt;&lt;/head&gt;&lt;body&gt;&lt;h1&gt;403&lt;/h1
SF:&gt;&lt;/body&gt;&lt;/html&gt;"</span><span class="o">)</span>%r<span class="o">(</span>mongodb,F5,<span class="s2">"HTTP/1</span><span class="se">\.</span><span class="s2">0</span><span class="se">\x</span><span class="s2">20403</span><span class="se">\x</span><span class="s2">20Forbidden</span><span class="se">\r\n</span><span class="s2">conten
SF:t-type:</span><span class="se">\x</span><span class="s2">20text/html</span><span class="se">\r\n</span><span class="s2">content-length:</span><span class="se">\x</span><span class="s2">20173</span><span class="se">\r\n\r\n</span><span class="s2">&lt;html&gt;&lt;head&gt;&lt;meta
SF:</span><span class="se">\x</span><span class="s2">20charset=utf-8</span><span class="se">\x</span><span class="s2">20http-equiv=</span><span class="se">\"</span><span class="s2">Content-Language</span><span class="se">\"\x</span><span class="s2">20content=</span><span class="se">\"</span><span class="s2">en</span><span class="se">\"</span><span class="s2">/
SF:&gt;&lt;link</span><span class="se">\x</span><span class="s2">20rel=</span><span class="se">\"</span><span class="s2">stylesheet</span><span class="se">\"\x</span><span class="s2">20type=</span><span class="se">\"</span><span class="s2">text/css</span><span class="se">\"\x</span><span class="s2">20href=</span><span class="se">\"</span><span class="s2">/error</span><span class="se">\.</span><span class="s2">css
SF:</span><span class="se">\"</span><span class="s2">/&gt;&lt;/head&gt;&lt;body&gt;&lt;h1&gt;403&lt;/h1&gt;&lt;/body&gt;&lt;/html&gt;"</span><span class="o">)</span>%r<span class="o">(</span>tarantool,F5,<span class="s2">"HTTP/1</span><span class="se">\.</span><span class="s2">0
SF:</span><span class="se">\x</span><span class="s2">20403</span><span class="se">\x</span><span class="s2">20Forbidden</span><span class="se">\r\n</span><span class="s2">content-type:</span><span class="se">\x</span><span class="s2">20text/html</span><span class="se">\r\n</span><span class="s2">content-length:</span><span class="se">\x</span><span class="s2">
SF:20173</span><span class="se">\r\n\r\n</span><span class="s2">&lt;html&gt;&lt;head&gt;&lt;meta</span><span class="se">\x</span><span class="s2">20charset=utf-8</span><span class="se">\x</span><span class="s2">20http-equiv=</span><span class="se">\"</span><span class="s2">Content
SF:-Language</span><span class="se">\"\x</span><span class="s2">20content=</span><span class="se">\"</span><span class="s2">en</span><span class="se">\"</span><span class="s2">/&gt;&lt;link</span><span class="se">\x</span><span class="s2">20rel=</span><span class="se">\"</span><span class="s2">stylesheet</span><span class="se">\"\x</span><span class="s2">20type=</span><span class="se">\"</span><span class="s2">te
SF:xt/css</span><span class="se">\"\x</span><span class="s2">20href=</span><span class="se">\"</span><span class="s2">/error</span><span class="se">\.</span><span class="s2">css</span><span class="se">\"</span><span class="s2">/&gt;&lt;/head&gt;&lt;body&gt;&lt;h1&gt;403&lt;/h1&gt;&lt;/body&gt;&lt;/htm
SF:l&gt;"</span><span class="o">)</span><span class="p">;</span>
Aggressive OS guesses: HP P2000 G3 NAS device <span class="o">(</span>93%<span class="o">)</span>, Linux 2.6.32 <span class="o">(</span>92%<span class="o">)</span>, Linux 2.6.32 - 3.1 <span class="o">(</span>92%<span class="o">)</span>, Infomir MAG-250 set-top box <span class="o">(</span>92%<span class="o">)</span>, Ubiquiti AirMax NanoStation WAP <span class="o">(</span>Linux 2.6.32<span class="o">)</span> <span class="o">(</span>92%<span class="o">)</span>, Linux 3.7 <span class="o">(</span>92%<span class="o">)</span>, Linux 5.0 <span class="o">(</span>92%<span class="o">)</span>, Linux 5.0 - 5.4 <span class="o">(</span>92%<span class="o">)</span>, Linux 5.1 <span class="o">(</span>92%<span class="o">)</span>, Ubiquiti AirOS 5.5.9 <span class="o">(</span>92%<span class="o">)</span>
No exact OS matches <span class="k">for </span>host <span class="o">(</span><span class="nb">test </span>conditions non-ideal<span class="o">)</span><span class="nb">.</span>
Network Distance: 7 hops
Service Info: OS: Linux<span class="p">;</span> CPE: cpe:/o:linux:linux_kernel

...

OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ <span class="nb">.</span>
Nmap <span class="k">done</span>: 1 IP address <span class="o">(</span>1 host up<span class="o">)</span> scanned <span class="k">in </span>152.56 seconds
</code></pre></div></div>

<p>Let’s check the http port 8000:</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241222032605.png" width="100%" alt="figure"></p>

<p>If you open the developer tools you can find the credentials in the comments:</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241223011207.png" width="100%" alt="figure"></p>

<p>So the solution for Santa Vision A is</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>elfanon
</code></pre></div></div>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241223012154.png" width="100%" alt="figure">
<img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241223012215.png" width="100%" alt="figure"></p>

<p>Let’s target Santa Vision B. If you login you see</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241223011338.png" width="100%" alt="figure"></p>

<p>The url is something like <a href="http://34.60.146.232:8000/auth?username=a&amp;pwd=a&amp;server=a&amp;port=a" target="_blank" rel="noopener noreferrer">http://34.60.146.232:8000/auth?username=a&amp;pwd=a&amp;server=a&amp;port=a</a>.</p>

<p>If you intercept this with something like Burp Suite you get</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241224002400.png" width="100%" alt="figure"></p>

<p>If you add id parameter</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241224002629.png" width="100%" alt="figure"></p>

<p>So there the id parameter missing. In the url you can add something like <code class="language-plaintext highlighter-rouge">&amp;id=1</code> at the end of the url and you get:</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241223011238.png" width="100%" alt="figure"></p>

<p>If you click at the bottom right you see availables roles</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241223011433.png" width="100%" alt="figure"></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>- SiteDefaultPasswordRole
- SiteElfMonitorRole
- SiteAlabsterSAdminRole
- SiteWomblyCAdminRole
</code></pre></div></div>

<p>And if you click left you see available clients</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241223011549.png" width="100%" alt="figure"></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>- elfmonitor
- WomblyC
- AlabasterS
</code></pre></div></div>

<p>Another port opened is ssh, I tried just to login with the same user like in http, 
but  a private key is needed:</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241223012002.png" width="100%" alt="figure"></p>

<p>Let’s recap what we have to focus for:</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241223012308.png" width="100%" alt="figure"></p>

<p>There is a button “Power On Monitors”</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241224002346.png" width="100%" alt="figure"></p>

<p>And a logout button</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241224002559.png" width="100%" alt="figure"></p>

<p>After a really long search, I found out that the credentials for the MQTT connection are located 
in the previously displayed clients and roles:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>- *elfmonitor*
- WomblyC
- AlabasterS
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>- SiteDefaultPasswordRole
- *SiteElfMonitorRole*
- SiteAlabsterSAdminRole
- SiteWomblyCAdminRole
</code></pre></div></div>

<p>So the solution for Santa Vision B is:</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241226004656.png" width="100%" alt="figure">
<img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241226004707.png" width="100%" alt="figure"></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>elfmonitor
</code></pre></div></div>

<p>If you talk to Ribb Bonbowford after that:</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241226005209.png" width="100%" alt="figure">
<img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241226005310.png" width="100%" alt="figure">
<img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241226005341.png" width="100%" alt="figure"></p>

<p>This gives a new hint:</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241226005542.png" width="100%" alt="figure"></p>

<p>To power on the monitors let’s use the password found in the roles:</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241228155609.png" width="100%" alt="figure"></p>

<p>Connect As: <code class="language-plaintext highlighter-rouge">elfmonitor</code></p>

<p>Password: <code class="language-plaintext highlighter-rouge">SiteElfMonitorRole</code></p>

<p>Enter the IP from the Time Travel before in <code class="language-plaintext highlighter-rouge">Camera Feed Server</code>. This is also the IP from the MQTT server.</p>

<p>For <code class="language-plaintext highlighter-rouge">Camera Feed Port</code> look at the nmap output, it’s <code class="language-plaintext highlighter-rouge">9001</code> for the MQTT server.</p>

<p>You should now could read <code class="language-plaintext highlighter-rouge">Monitors on. Connect to the broadcast feed</code></p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020241228155330.png" width="100%" alt="figure"></p>

<p>Let’s connect to <code class="language-plaintext highlighter-rouge">northpolefeeds</code> as mentioned in the text to Santa Vision B:</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020250101221014.png" width="100%" alt="figure"></p>

<p>The picture now shown are as follows:</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020250101221239.png" width="100%" alt="figure">
<img src="/blog/assets/img/hhc/2024/Pasted%20image%2020250101221249.png" width="100%" alt="figure"></p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020250101221159.png" width="100%" alt="figure">
<img src="/blog/assets/img/hhc/2024/Pasted%20image%2020250101221209.png" width="100%" alt="figure">
<img src="/blog/assets/img/hhc/2024/Pasted%20image%2020250101221054.png" width="100%" alt="figure">
<img src="/blog/assets/img/hhc/2024/Pasted%20image%2020250101221126.png" width="100%" alt="figure">
<img src="/blog/assets/img/hhc/2024/Pasted%20image%2020250101221140.png" width="100%" alt="figure"></p>

<p>So this seems to be advertising for the two combating parts.
What’s written in the next challenge of Santa Vision?</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020250101215048.png" width="100%" alt="figure"></p>

<p>Ok, then let’s do that!
For that proceed the same way as above, click to “Connect to broadcast feed” and
as value set <code class="language-plaintext highlighter-rouge">frostbitfeed</code> as Broadcast feed:</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020250101215448.png" width="100%" alt="figure"></p>

<p>This yields to output of <code class="language-plaintext highlighter-rouge">frostbitfeed</code> whose messages look like this:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Frostbite is a serious condition that can cause permanent damage to the body and/or network
Frostbit is a leading cause of network downtime
Frostbite can be prevented by using a firewall and keeping your network secure
While good backups are important, they won't prevent frostbite
To prevent frostbite, you should wear appropriate clothing and cover exposed skin and ports
Be sure everyone knows the signs and symptoms of frostbite
Frostbite can occur in as little as 30 minutes in extreme cold - faster in flat networks
Additional messages available in santafeed
Error msg: Unauthorized access attempt. /api/v1/frostbitadmin/bot/&lt;botuuid&gt;/deactivate, authHeader: X-API-Key, status: Invalid Key, alert: Warning, recipient: Wombley
Do you conduct regular frostbite preparedness exercises?
Let's Encrypt cert for api.frostbit.app verified. at path /etc/nginx/certs/api.frostbit.app.key
</code></pre></div></div>

<p>This gives a hint to another feed in on of the messages: <code class="language-plaintext highlighter-rouge">santafeed</code>.</p>

<p>Let’s look into that:</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020250101220313.png" width="100%" alt="figure"></p>

<p>Gathered this is:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Santa is making his list.
Santa is checking his list.
Santa role: superadmin
WombleyC role: admin
AlabasterS role: admin
Sixteen elves launched operation: Idemcerybu
singleAdminMode=false
Santa role: superadmin
superAdminMode=true
Santa is on his way to the North Pole
</code></pre></div></div>

<p>If you look very carefully you can read <code class="language-plaintext highlighter-rouge">Sixteen elves launched operation: Idemcerybu</code>.
So the secret operation asked in for Santa Vision C is</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Idemcerybu
</code></pre></div></div>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020250101220656.png" width="100%" alt="figure">
<img src="/blog/assets/img/hhc/2024/Pasted%20image%2020250101220706.png" width="100%" alt="figure"></p>

<p>The next part of the challenge is:</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020250102220905.png" width="100%" alt="figure"></p>

<p>Perhaps talk to Ribb Bonbowford again:</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020250102220511.png" width="100%" alt="figure">
<img src="/blog/assets/img/hhc/2024/Pasted%20image%2020250102220631.png" width="100%" alt="figure"></p>

<p>He says: “-send the right message, and Santa’s true spirit will return”.
So we have to send something, which means in MQTT terms we have to publish something.</p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020250102231603.png" width="100%" alt="figure"></p>

<p><img src="/blog/assets/img/hhc/2024/Pasted%20image%2020250103003431.png" width="100%" alt="figure">
<img src="/blog/assets/img/hhc/2024/Pasted%20image%2020250103003516.png" width="100%" alt="figure"></p>


            </div>
        </div>
    </div>
</article>

<hr>

<!-- Footer -->
<footer>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-md-10 mx-auto">
                <ul class="list-inline text-center">
                    <li class="list-inline-item">
                        <a href="https://secf00tprint.github.io/feed.xml">
                  <span class="fa-stack fa-lg">
                    <i class="fa fa-circle fa-stack-2x"></i>
                    <i class="fa fa-rss fa-stack-1x fa-inverse"></i>
                  </span>
                        </a>
                    </li>
                    <li class="list-inline-item">
                        <a href="https://github.com/secf00tprint" target="_blank" rel="noopener noreferrer">
                  <span class="fa-stack fa-lg">
                    <i class="fa fa-circle fa-stack-2x"></i>
                    <i class="fab fa-github fa-stack-1x fa-inverse"></i>
                  </span>
                        </a>
                    </li>
                    <li class="list-inline-item">
                        <a href="https://www.xing.com/profile/Matthias_Altmann9" target="_blank" rel="noopener noreferrer">
                  <span class="fa-stack fa-lg">
                    <i class="fa fa-circle fa-stack-2x"></i>
                    <i class="fab fa-xing fa-stack-1x fa-inverse"></i>
                  </span>
                        </a>
                    </li>
                </ul>
                <p class="copyright text-muted">©2025 <a href="/blog/legal/legalstuff.html">Legal Stuff</a></p>
            </div>
        </div>
    </div>
</footer>

</body>

</html>
